<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>lecture-05-content – 🔥 Quantitative Research Methods</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/quarto-contrib/bootstrap-icons-1.11.1/all.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<meta name="mermaid-theme" content="default">
<script src="../site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="../site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="../site_libs/quarto-diagram/mermaid.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">🔥 Quantitative Research Methods</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../syllabus/syllabus.html" aria-current="page"> <i class="bi bi-info-circle-fill" role="img">
</i> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../lectures/list-lectures.html"> <i class="bi bi-journal-code" role="img">
</i> 
<span class="menu-text">Class &amp; Lab Notes</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-slides" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-file-slides-fill" role="img">
</i> 
 <span class="menu-text">Slides</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-slides">    
        <li>
    <a class="dropdown-item" href="../lectures/lecture-01-slides.html">
 <span class="dropdown-text">Class 01 – <strong>Introduction</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-02-slides.html">
 <span class="dropdown-text">Class 02 – <strong>Telling Stories with Data</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-03-slides.html">
 <span class="dropdown-text">Class 03 – <strong>Workflow – Plan, Simulate, Acquire, Explore, Share</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-04-slides.html">
 <span class="dropdown-text">Class 04 – <strong>Good and Bad Ways to Look at Data</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-05-slides.html">
 <span class="dropdown-text">Class 05 – <strong>Reproducibility + Getting Started with R and RStudio</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-06-slides.html">
 <span class="dropdown-text">Class 06 – <strong>Reproducibility + Getting Started with R and RStudio</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-07-slides.html">
 <span class="dropdown-text">Class 07 – <strong>Writing and Developing Research Questions</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-08-slides.html">
 <span class="dropdown-text">Class 08 – <strong>The Grammar of Graphics, Plotting in the Tidyverse</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-09-slides.html">
 <span class="dropdown-text">Class 09 – <strong>Showing the Right Numbers</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-10-slides.html">
 <span class="dropdown-text">Class 10 – <strong>Piping, Summarizing, and Transforming</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-11-slides.html">
 <span class="dropdown-text">Class 11 – <strong>Measurement</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-12-slides.html">
 <span class="dropdown-text">Class 12 – <strong>Sampling</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-13-slides.html">
 <span class="dropdown-text">Class 13 – <strong>Experiments</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-14-slides.html">
 <span class="dropdown-text">Class 14 – <strong>Surveys</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-15-slides.html">
 <span class="dropdown-text">Class 15 – <strong>Data Cleaning and Preparation</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-16-slides.html">
 <span class="dropdown-text">Class 16 – <strong>Exploratory Data Analysis (EDA)</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-17-slides.html">
 <span class="dropdown-text">Class 17 – <strong>Linear Models</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-18-slides.html">
 <span class="dropdown-text">Class 18 – <strong>Linear Models + Model-based Graphics</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-19-slides.html">
 <span class="dropdown-text">Class 19 – <strong>Generalized Linear Models (Binary Outcomes)</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-20-slides.html">
 <span class="dropdown-text">Class 20 – <strong>Generalized Linear Models (Count Outcomes)</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-21-slides.html">
 <span class="dropdown-text">Class 21 – <strong>Mutilevel Models</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-22-slides.html">
 <span class="dropdown-text">Class 22 – <strong>Mutilevel Models</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-23-slides.html">
 <span class="dropdown-text">Class 23 – <strong>Multilevel Regression with Poststratification (MRP)</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-24-slides.html">
 <span class="dropdown-text">Class 24 – <strong>Project Work</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-25-slides.html">
 <span class="dropdown-text">Class 25 – <strong>Project Work</strong></span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-telling-stories-with-data" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-fire" role="img">
</i> 
 <span class="menu-text">Telling Stories with Data</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-telling-stories-with-data">    
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com">
 <span class="dropdown-text"><strong>Preface</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/01-introduction.html">
 <span class="dropdown-text">Chapter 01 – <strong>Telling stories with data</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/02-drinking_from_a_fire_hose.html">
 <span class="dropdown-text">Chapter 02 – <strong>Drinking from a fire hose</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/03-workflow.html">
 <span class="dropdown-text">Chapter 03 – <strong>Reproducible workflows</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/04-writing_research.html">
 <span class="dropdown-text">Chapter 04 – <strong>Writing research</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/05-static_communication.html">
 <span class="dropdown-text">Chapter 05 – <strong>Graphs, tables, and maps</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/06-farm.html">
 <span class="dropdown-text">Chapter 06 – <strong>Measurement, censuses, and sampling</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/07-gather.html">
 <span class="dropdown-text">Chapter 07 – <strong>APIs, scraping, and parsing</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/08-hunt.html">
 <span class="dropdown-text">Chapter 08 – <strong>Experiments and surveys</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/09-clean_and_prepare.html">
 <span class="dropdown-text">Chapter 09 – <strong>Clean and prepare</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/10-store_and_share.html">
 <span class="dropdown-text">Chapter 10 – <strong>Store and share</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/11-eda.html">
 <span class="dropdown-text">Chapter 11 – <strong>Exploratory data analysis</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/12-ijalm.html">
 <span class="dropdown-text">Chapter 12 – <strong>Linear models</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/13-ijaglm.html">
 <span class="dropdown-text">Chapter 13 – <strong>Generalized Linear Models</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/13-prediction.html">
 <span class="dropdown-text">Chapter 14 – <strong>Prediction</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Causality from observational data">
 <span class="dropdown-text">Chapter 15 – <strong>Causality from observational data</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/15-mrp.html">
 <span class="dropdown-text">Chapter 16 – <strong>Multilevel regression with post-stratification</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/16-text.html">
 <span class="dropdown-text">Chapter 17 – <strong>Text as data</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/17-concluding.html">
 <span class="dropdown-text">Chapter 18 – <strong>Concluding remarks</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/20-r_essentials.html">
 <span class="dropdown-text">Appendix – <strong>R essentials</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/21-datasets.html">
 <span class="dropdown-text">Appendix – <strong>Datasets</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/25-datasheet.html">
 <span class="dropdown-text">Appendix – <strong>Datasheets</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/98-cocktails.html">
 <span class="dropdown-text">Appendix – <strong>Cocktails 🥃🍸</strong></span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-data-visualization" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-activity" role="img">
</i> 
 <span class="menu-text">Data Visualization</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-data-visualization">    
        <li>
    <a class="dropdown-item" href="https://socviz.co/index.html">
 <span class="dropdown-text"><strong>Preface</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://socviz.co/lookatdata.html#lookatdata">
 <span class="dropdown-text">Chapter 1 – <strong>Look at Data</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://socviz.co/gettingstarted.html#gettingstarted">
 <span class="dropdown-text">Chapter 2 – <strong>Get Started</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://socviz.co/makeplot.html#makeplot">
 <span class="dropdown-text">Chapter 3 – <strong>Make a Plot</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://socviz.co/groupfacettx.html#groupfacettx">
 <span class="dropdown-text">Chapter 4 – <strong>Show the Right Numbers</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://socviz.co/workgeoms.html#workgeoms">
 <span class="dropdown-text">Chapter 5 – <strong>Graph Tables, Add Labels, Make Notes</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://socviz.co/modeling.html#modeling">
 <span class="dropdown-text">Chapter 6 – <strong>Work with Models</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://socviz.co/maps.html#maps">
 <span class="dropdown-text">Chapter 7 – <strong>Draw Maps</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://socviz.co/refineplots.html#refineplots">
 <span class="dropdown-text">Chapter 8 – <strong>Refine Your Plots</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://socviz.co/appendix.html#appendix">
 <span class="dropdown-text"><strong>Appendix</strong></span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://www.johnmclevey.com"> 
<span class="menu-text">John McLevey</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
  <div id="quarto-announcement" data-announcement-id="4e844bf18abc78b881990e274941979b" class="alert alert-info hidden"><i class="bi bi-cone-striped quarto-announcement-icon"></i><div class="quarto-announcement-content">
<p><strong>WORK IN PROGRESS</strong> – I am actively developing these course materials. They are not yet complete and may change at any point before the first day of class in January 2025. ✌️ John</p>
</div><i class="bi bi-x-lg quarto-announcement-action"></i></div>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>SYLLABUS</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus/syllabus.html" class="sidebar-item-text sidebar-link"><i class="bi bi-info-circle-fill" role="img">
</i> 
 <span class="menu-text">&nbsp;&nbsp;SOCI 3040</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus/schedule.html" class="sidebar-item-text sidebar-link"><i class="bi bi-calendar-fill" role="img">
</i> 
 <span class="menu-text">&nbsp;&nbsp;Course Schedule</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus/assessment.html" class="sidebar-item-text sidebar-link"><i class="bi bi-check2-square" role="img">
</i> 
 <span class="menu-text">&nbsp;&nbsp;Assessment</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus/computing.html" class="sidebar-item-text sidebar-link"><i class="bi bi-laptop" role="img">
</i> 
 <span class="menu-text">&nbsp;&nbsp;Computing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus/conventions.html" class="sidebar-item-text sidebar-link"><i class="bi bi-signpost-split-fill" role="img">
</i> 
 <span class="menu-text">&nbsp;&nbsp;Conventions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus/notation.html" class="sidebar-item-text sidebar-link"><i class="bi bi-pencil" role="img">
</i> 
 <span class="menu-text">&nbsp;&nbsp;Model Notation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus/policies.html" class="sidebar-item-text sidebar-link"><i class="bi bi-box-fill" role="img">
</i> 
 <span class="menu-text">&nbsp;&nbsp;Policies</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
 <span class="menu-text"><br></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>ASSIGNMENTS</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../deliverables/assignment-1.html" class="sidebar-item-text sidebar-link"><i class="bi bi-file-post" role="img">
</i> 
 <span class="menu-text">&nbsp;&nbsp;Data Stories 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../deliverables/assignment-2.html" class="sidebar-item-text sidebar-link"><i class="bi bi-file-post" role="img">
</i> 
 <span class="menu-text">&nbsp;&nbsp;Data Stories 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../deliverables/assignment-3.html" class="sidebar-item-text sidebar-link"><i class="bi bi-file-post" role="img">
</i> 
 <span class="menu-text">&nbsp;&nbsp;Data Stories 3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../deliverables/assignment-4.html" class="sidebar-item-text sidebar-link"><i class="bi bi-file-post" role="img">
</i> 
 <span class="menu-text">&nbsp;&nbsp;Data Stories 4</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
 <span class="menu-text"><br></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>QUICK LINKS</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://online.mun.ca/d2l/home/605570" class="sidebar-item-text sidebar-link"><i class="bi bi-link-45deg" role="img">
</i> 
 <span class="menu-text">&nbsp;&nbsp;3040 on Brightspace</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://www.mun.ca/studentwellness/" class="sidebar-item-text sidebar-link"><i class="bi bi-link-45deg" role="img">
</i> 
 <span class="menu-text">&nbsp;&nbsp;Student Wellness</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://www.mun.ca/studentwellness/counselling-services/" class="sidebar-item-text sidebar-link"><i class="bi bi-link-45deg" role="img">
</i> 
 <span class="menu-text">&nbsp;&nbsp;Counselling Centre</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://www.mun.ca/munup/academic-success-centre/" class="sidebar-item-text sidebar-link"><i class="bi bi-link-45deg" role="img">
</i> 
 <span class="menu-text">&nbsp;&nbsp;Academic Success Centre</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://www.mun.ca/munup/academic-success-centre/learning-supports/accessibility-services/" class="sidebar-item-text sidebar-link"><i class="bi bi-link-45deg" role="img">
</i> 
 <span class="menu-text">&nbsp;&nbsp;Accessibility Services</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="-1">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#get-started" id="toc-get-started" class="nav-link active" data-scroll-target="#get-started">Get Started</a>
  <ul>
  <li><a href="#key-concepts-and-skills" id="toc-key-concepts-and-skills" class="nav-link" data-scroll-target="#key-concepts-and-skills">Key concepts and skills</a></li>
  <li><a href="#software-and-packages" id="toc-software-and-packages" class="nav-link" data-scroll-target="#software-and-packages">Software and packages</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1"></a></li>
  <li><a href="#section-2" id="toc-section-2" class="nav-link" data-scroll-target="#section-2"></a></li>
  <li><a href="#section-3" id="toc-section-3" class="nav-link" data-scroll-target="#section-3"></a></li>
  <li><a href="#section-4" id="toc-section-4" class="nav-link" data-scroll-target="#section-4"></a></li>
  <li><a href="#quarto" id="toc-quarto" class="nav-link" data-scroll-target="#quarto">Quarto</a>
  <ul>
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started">Getting started</a></li>
  </ul></li>
  <li><a href="#section-5" id="toc-section-5" class="nav-link" data-scroll-target="#section-5"></a></li>
  <li><a href="#section-6" id="toc-section-6" class="nav-link" data-scroll-target="#section-6"></a>
  <ul>
  <li><a href="#top-matter" id="toc-top-matter" class="nav-link" data-scroll-target="#top-matter">Top matter</a></li>
  </ul></li>
  <li><a href="#section-7" id="toc-section-7" class="nav-link" data-scroll-target="#section-7"></a></li>
  <li><a href="#section-8" id="toc-section-8" class="nav-link" data-scroll-target="#section-8"></a></li>
  <li><a href="#section-9" id="toc-section-9" class="nav-link" data-scroll-target="#section-9"></a></li>
  <li><a href="#section-10" id="toc-section-10" class="nav-link" data-scroll-target="#section-10"></a></li>
  <li><a href="#section-11" id="toc-section-11" class="nav-link" data-scroll-target="#section-11"></a></li>
  <li><a href="#section-12" id="toc-section-12" class="nav-link" data-scroll-target="#section-12"></a></li>
  <li><a href="#section-13" id="toc-section-13" class="nav-link" data-scroll-target="#section-13"></a></li>
  <li><a href="#section-14" id="toc-section-14" class="nav-link" data-scroll-target="#section-14"></a>
  <ul>
  <li><a href="#essential-commands" id="toc-essential-commands" class="nav-link" data-scroll-target="#essential-commands">Essential commands</a></li>
  </ul></li>
  <li><a href="#section-15" id="toc-section-15" class="nav-link" data-scroll-target="#section-15"></a></li>
  <li><a href="#section-16" id="toc-section-16" class="nav-link" data-scroll-target="#section-16"></a>
  <ul>
  <li><a href="#r-chunks" id="toc-r-chunks" class="nav-link" data-scroll-target="#r-chunks">R chunks</a></li>
  </ul></li>
  <li><a href="#section-17" id="toc-section-17" class="nav-link" data-scroll-target="#section-17"></a>
  <ul>
  <li><a href="#sec-equations" id="toc-sec-equations" class="nav-link" data-scroll-target="#sec-equations">Equations</a></li>
  </ul></li>
  <li><a href="#section-18" id="toc-section-18" class="nav-link" data-scroll-target="#section-18"></a></li>
  <li><a href="#section-19" id="toc-section-19" class="nav-link" data-scroll-target="#section-19"></a></li>
  <li><a href="#section-20" id="toc-section-20" class="nav-link" data-scroll-target="#section-20"></a></li>
  <li><a href="#section-21" id="toc-section-21" class="nav-link" data-scroll-target="#section-21"></a></li>
  <li><a href="#section-22" id="toc-section-22" class="nav-link" data-scroll-target="#section-22"></a></li>
  <li><a href="#section-23" id="toc-section-23" class="nav-link" data-scroll-target="#section-23"></a>
  <ul>
  <li><a href="#sec-quartocrossreferences" id="toc-sec-quartocrossreferences" class="nav-link" data-scroll-target="#sec-quartocrossreferences">Cross-references</a></li>
  </ul></li>
  <li><a href="#section-24" id="toc-section-24" class="nav-link" data-scroll-target="#section-24"></a></li>
  <li><a href="#section-25" id="toc-section-25" class="nav-link" data-scroll-target="#section-25"></a></li>
  <li><a href="#section-26" id="toc-section-26" class="nav-link" data-scroll-target="#section-26"></a></li>
  <li><a href="#section-27" id="toc-section-27" class="nav-link" data-scroll-target="#section-27"></a></li>
  <li><a href="#r-projects-and-file-structure" id="toc-r-projects-and-file-structure" class="nav-link" data-scroll-target="#r-projects-and-file-structure">R Projects and file structure</a></li>
  <li><a href="#section-28" id="toc-section-28" class="nav-link" data-scroll-target="#section-28"></a></li>
  <li><a href="#section-29" id="toc-section-29" class="nav-link" data-scroll-target="#section-29"></a></li>
  <li><a href="#section-30" id="toc-section-30" class="nav-link" data-scroll-target="#section-30"></a></li>
  <li><a href="#section-31" id="toc-section-31" class="nav-link" data-scroll-target="#section-31"></a></li>
  </ul></li>
  <li><a href="#version-control" id="toc-version-control" class="nav-link" data-scroll-target="#version-control"><i class="bi-github " style="" role="img" aria-hidden="true"></i> Version Control</a>
  <ul>
  <li><a href="#section-32" id="toc-section-32" class="nav-link" data-scroll-target="#section-32"></a></li>
  <li><a href="#section-33" id="toc-section-33" class="nav-link" data-scroll-target="#section-33"></a></li>
  <li><a href="#section-34" id="toc-section-34" class="nav-link" data-scroll-target="#section-34"></a></li>
  <li><a href="#section-35" id="toc-section-35" class="nav-link" data-scroll-target="#section-35"></a></li>
  <li><a href="#section-36" id="toc-section-36" class="nav-link" data-scroll-target="#section-36"></a>
  <ul>
  <li><a href="#git" id="toc-git" class="nav-link" data-scroll-target="#git">Git</a></li>
  </ul></li>
  <li><a href="#section-37" id="toc-section-37" class="nav-link" data-scroll-target="#section-37"></a></li>
  <li><a href="#section-38" id="toc-section-38" class="nav-link" data-scroll-target="#section-38"></a></li>
  <li><a href="#section-39" id="toc-section-39" class="nav-link" data-scroll-target="#section-39"></a>
  <ul>
  <li><a href="#github" id="toc-github" class="nav-link" data-scroll-target="#github">GitHub</a></li>
  </ul></li>
  <li><a href="#section-40" id="toc-section-40" class="nav-link" data-scroll-target="#section-40"></a></li>
  <li><a href="#section-41" id="toc-section-41" class="nav-link" data-scroll-target="#section-41"></a></li>
  <li><a href="#section-42" id="toc-section-42" class="nav-link" data-scroll-target="#section-42"></a></li>
  <li><a href="#section-43" id="toc-section-43" class="nav-link" data-scroll-target="#section-43"></a></li>
  <li><a href="#section-44" id="toc-section-44" class="nav-link" data-scroll-target="#section-44"></a></li>
  <li><a href="#section-45" id="toc-section-45" class="nav-link" data-scroll-target="#section-45"></a></li>
  <li><a href="#section-46" id="toc-section-46" class="nav-link" data-scroll-target="#section-46"></a></li>
  <li><a href="#section-47" id="toc-section-47" class="nav-link" data-scroll-target="#section-47"></a></li>
  <li><a href="#section-48" id="toc-section-48" class="nav-link" data-scroll-target="#section-48"></a></li>
  </ul></li>
  <li><a href="#using-r-in-practice" id="toc-using-r-in-practice" class="nav-link" data-scroll-target="#using-r-in-practice">Using R in practice</a>
  <ul>
  <li><a href="#sec-dealingwitherrors" id="toc-sec-dealingwitherrors" class="nav-link" data-scroll-target="#sec-dealingwitherrors">Dealing with errors</a></li>
  <li><a href="#section-49" id="toc-section-49" class="nav-link" data-scroll-target="#section-49"></a></li>
  <li><a href="#section-50" id="toc-section-50" class="nav-link" data-scroll-target="#section-50"></a></li>
  <li><a href="#section-51" id="toc-section-51" class="nav-link" data-scroll-target="#section-51"></a>
  <ul>
  <li><a href="#sec-omgpleasemakeareprexplease" id="toc-sec-omgpleasemakeareprexplease" class="nav-link" data-scroll-target="#sec-omgpleasemakeareprexplease">Reproducible examples</a></li>
  </ul></li>
  <li><a href="#section-52" id="toc-section-52" class="nav-link" data-scroll-target="#section-52"></a></li>
  <li><a href="#section-53" id="toc-section-53" class="nav-link" data-scroll-target="#section-53"></a></li>
  <li><a href="#section-54" id="toc-section-54" class="nav-link" data-scroll-target="#section-54"></a>
  <ul>
  <li><a href="#mentality" id="toc-mentality" class="nav-link" data-scroll-target="#mentality">Mentality</a></li>
  </ul></li>
  <li><a href="#section-55" id="toc-section-55" class="nav-link" data-scroll-target="#section-55"></a></li>
  <li><a href="#code-comments-and-style" id="toc-code-comments-and-style" class="nav-link" data-scroll-target="#code-comments-and-style">Code comments and style</a></li>
  <li><a href="#section-56" id="toc-section-56" class="nav-link" data-scroll-target="#section-56"></a></li>
  <li><a href="#section-57" id="toc-section-57" class="nav-link" data-scroll-target="#section-57"></a></li>
  <li><a href="#section-58" id="toc-section-58" class="nav-link" data-scroll-target="#section-58"></a></li>
  <li><a href="#section-59" id="toc-section-59" class="nav-link" data-scroll-target="#section-59"></a></li>
  <li><a href="#tests" id="toc-tests" class="nav-link" data-scroll-target="#tests">Tests</a></li>
  <li><a href="#section-60" id="toc-section-60" class="nav-link" data-scroll-target="#section-60"></a></li>
  <li><a href="#section-61" id="toc-section-61" class="nav-link" data-scroll-target="#section-61"></a></li>
  <li><a href="#section-62" id="toc-section-62" class="nav-link" data-scroll-target="#section-62"></a></li>
  <li><a href="#efficiency" id="toc-efficiency" class="nav-link" data-scroll-target="#efficiency">Efficiency</a></li>
  <li><a href="#section-63" id="toc-section-63" class="nav-link" data-scroll-target="#section-63"></a></li>
  <li><a href="#sharing-a-code-environment" id="toc-sharing-a-code-environment" class="nav-link" data-scroll-target="#sharing-a-code-environment">Sharing a code environment</a></li>
  <li><a href="#section-64" id="toc-section-64" class="nav-link" data-scroll-target="#section-64"></a></li>
  <li><a href="#section-65" id="toc-section-65" class="nav-link" data-scroll-target="#section-65"></a></li>
  <li><a href="#section-66" id="toc-section-66" class="nav-link" data-scroll-target="#section-66"></a></li>
  <li><a href="#code-linting-and-styling" id="toc-code-linting-and-styling" class="nav-link" data-scroll-target="#code-linting-and-styling">Code linting and styling</a></li>
  <li><a href="#section-67" id="toc-section-67" class="nav-link" data-scroll-target="#section-67"></a></li>
  <li><a href="#section-68" id="toc-section-68" class="nav-link" data-scroll-target="#section-68"></a></li>
  <li><a href="#section-69" id="toc-section-69" class="nav-link" data-scroll-target="#section-69"></a></li>
  <li><a href="#section-70" id="toc-section-70" class="nav-link" data-scroll-target="#section-70"></a></li>
  <li><a href="#section-71" id="toc-section-71" class="nav-link" data-scroll-target="#section-71"></a></li>
  <li><a href="#section-72" id="toc-section-72" class="nav-link" data-scroll-target="#section-72"></a></li>
  <li><a href="#code-review" id="toc-code-review" class="nav-link" data-scroll-target="#code-review">Code review</a></li>
  <li><a href="#section-73" id="toc-section-73" class="nav-link" data-scroll-target="#section-73"></a></li>
  <li><a href="#section-74" id="toc-section-74" class="nav-link" data-scroll-target="#section-74"></a></li>
  <li><a href="#section-75" id="toc-section-75" class="nav-link" data-scroll-target="#section-75"></a></li>
  <li><a href="#code-refactoring" id="toc-code-refactoring" class="nav-link" data-scroll-target="#code-refactoring">Code refactoring</a></li>
  <li><a href="#section-76" id="toc-section-76" class="nav-link" data-scroll-target="#section-76"></a></li>
  <li><a href="#section-77" id="toc-section-77" class="nav-link" data-scroll-target="#section-77"></a></li>
  <li><a href="#section-78" id="toc-section-78" class="nav-link" data-scroll-target="#section-78"></a></li>
  <li><a href="#section-79" id="toc-section-79" class="nav-link" data-scroll-target="#section-79"></a></li>
  <li><a href="#concluding-remarks" id="toc-concluding-remarks" class="nav-link" data-scroll-target="#concluding-remarks">Concluding remarks</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">




<section id="get-started" class="level1">
<h1>Get Started</h1>
<section id="key-concepts-and-skills" class="level2">
<h2 class="anchored" data-anchor-id="key-concepts-and-skills">Key concepts and skills</h2>
<p><strong>Key concepts and skills</strong></p>
<ul>
<li>Reproducibility typically begins as something that someone imposes on you. It can be onerous and annoying. This typically lasts until you need to revisit a project after a small break. At that point you typically realize that reproducibility is not just a requirement for data science because it is the only way that we can make genuine progress, but because it helps us help ourselves.</li>
<li>Reproducibility implies sharing data, code, and environment. This is enhanced by using Quarto, R Projects, and Git and GitHub: Quarto builds documents that integrate normal text and R code; R Projects enable a file structure that is not dependent on a user’s personal directory set-up; and Git and GitHub make it easier to share code and data.</li>
<li>This is not an unimpeachable workflow, but one that is good enough and provides many of the benefits. We will improve various aspects of it through various tools, but improving code structure and comments goes a long way.</li>
<li>There are always errors that occur, and it is important to recognize that debugging is a skill that improves with practice. But one key aspect of being able to get help is to be able to make a reproducible example others can use.</li>
</ul>
</section>
<section id="software-and-packages" class="level2">
<h2 class="anchored" data-anchor-id="software-and-packages">Software and packages</h2>
<div class="columns">
<div class="column">
<ul>
<li>Base R <span class="citation" data-cites="citeR">[@citeR]</span></li>
<li><code>AER</code> <span class="citation" data-cites="citeaer">[@citeaer]</span></li>
<li><code>future</code> <span class="citation" data-cites="future">[@future]</span></li>
<li><code>gitcreds</code> <span class="citation" data-cites="gitcreds">[@gitcreds]</span></li>
<li><code>knitr</code> <span class="citation" data-cites="citeknitr">[@citeknitr]</span></li>
<li><code>lintr</code> <span class="citation" data-cites="lintr">[@lintr]</span></li>
<li><code>renv</code> <span class="citation" data-cites="renv">[@renv]</span></li>
<li><code>reprex</code> <span class="citation" data-cites="reprex">[@reprex]</span></li>
<li><code>styler</code> <span class="citation" data-cites="styler">[@styler]</span></li>
<li><code>tidyverse</code> <span class="citation" data-cites="tidyverse">[@tidyverse]</span></li>
<li><code>tinytex</code> <span class="citation" data-cites="tinytex">[@tinytex]</span></li>
<li><code>usethis</code> <span class="citation" data-cites="usethis">[@usethis]</span></li>
</ul>
</div><div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(future)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gitcreds)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lintr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(renv)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reprex)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(styler)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tinytex)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(usethis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section"></h2>
<blockquote class="blockquote">
<p>The number one thing to keep in mind about machine learning is that performance is evaluated on samples from one dataset, but the model is used in production on samples that may not necessarily follow the same characteristics<span class="math inline">\(\dots\)</span> So when asking the question, “would you rather use a model that was evaluated as 90% accurate, or a human that was evaluated as 80% accurate”, the answer depends on whether your data is typical per the evaluation process. Humans are adaptable, models are not. If significant uncertainty is involved, go with the human. They may have inferior pattern recognition capabilities (versus models trained on enormous amounts of data), but they understand what they do, they can reason about it, and they can improvise when faced with novelty.</p>
<p>François Chollet, 20 February 2020.</p>
</blockquote>
<p>If science is about systematically building and organizing knowledge in terms of testable explanations and predictions, then data science takes this and focuses on data. This means that building, organizing, and sharing knowledge is a critical aspect. Creating knowledge, once, in a way that only you can do it, does not meet this standard. Hence, there is a need for reproducible data science workflows.</p>
<p><span class="citation" data-cites="Alexander2019">@Alexander2019</span> defines reproducible research as that which can be exactly redone, given all the materials used. This underscores the importance of providing the code, data, and environment. The minimum expectation is that another person is independently able to use your code, data, and environment to get your results, including figures and tables. Ironically, there are different definitions of reproducibility between disciplines. <span class="citation" data-cites="barba2018terminologies">@barba2018terminologies</span> surveys a variety of disciplines and concludes that the predominant language usage implies the following definitions:</p>
<ul>
<li>Reproducible research is when “[a]uthors provide all the necessary data and the computer codes to run the analysis again, re-creating the results.”</li>
<li>A replication is a study “that arrives at the same scientific findings as another study, collecting new data (possibly with different methods) and completing new analyses.”</li>
</ul>
<p>Regardless of what it is specifically called, <span class="citation" data-cites="Gelman2016">@Gelman2016</span> identifies how large an issue the lack of it is in various social sciences. Work that is not reproducible does not contribute to our stock of knowledge about the world. This is wasteful and potentially even unethical. Since <span class="citation" data-cites="Gelman2016">@Gelman2016</span>, a great deal of work has been done in many social sciences and the situation has improved a little, but much work remains. That is also the case in the life sciences <span class="citation" data-cites="heil2021reproducibility">[@heil2021reproducibility]</span>, cancer research <span class="citation" data-cites="Begley2012 Mullard2021">[@Begley2012; @Mullard2021]</span>, and computer science <span class="citation" data-cites="pineau2021improving">[@pineau2021improving]</span>.</p>
<p>Some of the examples that <span class="citation" data-cites="Gelman2016">@Gelman2016</span> talks about are not that important in the scheme of things. But at the same time, we saw, and continue to see, similar approaches being used in areas with big impacts. For instance, many governments have created “nudge” units that implement public policy <span class="citation" data-cites="sunstein2017economics">[@sunstein2017economics]</span> even though there is evidence that some of the claims lack credibility <span class="citation" data-cites="nonudge gelmannudge">[@nonudge; @gelmannudge]</span>. Governments are increasingly using algorithms that they do not make open <span class="citation" data-cites="chouldechova18a">[@chouldechova18a]</span>. And <span class="citation" data-cites="herndon2014does">@herndon2014does</span> document how research in economics that was used by governments to justify austerity policies following the 2007–2008 financial crisis turned out to not be reproducible.</p>
<p>At a minimum, and with few exceptions, we must release our code, datasets, and environment. Without these, it is difficult to know what a finding speaks to <span class="citation" data-cites="miyakawa2020no">[@miyakawa2020no]</span>. More banally, we also do not know if there are mistakes or aspects that were inadvertently overlooked <span class="citation" data-cites="merali2010computational hillelwayne natefixesmistake">[@merali2010computational; @hillelwayne; @natefixesmistake]</span>. Increasingly, following <span class="citation" data-cites="buckheit1995wavelab">@buckheit1995wavelab</span>, we consider a paper to be an advertisement, and for the associated code, data, and environment to be the actual work. Steve Jobs, a co-founder of Apple, talked about how people who are the best at their craft ensure that even the aspects of their work that no one else will ever see are as well finished and high quality as the aspects that are public facing <span class="citation" data-cites="stevejobs">[@stevejobs]</span>. The same is true in data science, where often one of the distinguishing aspects of high-quality work is that the README and code comments are as polished as, say, the abstract of the associated paper.</p>
</section>
<section id="section-1" class="level2">
<h2 class="anchored" data-anchor-id="section-1"></h2>
<p>Workflows exist within a cultural and social context, which imposes an additional ethical reason for the need for them to be reproducible. For instance, <span class="citation" data-cites="wang2018deep">@wang2018deep</span> train a neural network to distinguish between the faces of gay and heterosexual men. (<span class="citation" data-cites="murphy2017">@murphy2017</span> provides a summary of the paper, the associated issues, and comments from its authors.) To do this, <span class="citation" data-cites="wang2018deep">@wang2018deep [p. 248]</span> needed a dataset of photos of people that were “adult, Caucasian, fully visible, and of a gender that matched the one reported on the user’s profile”. They verified this using Amazon Mechanical Turk, an online platform that pays workers a small amount of money to complete specific tasks. The instructions provided to the Mechanical Turk workers for this task specify that Barack Obama, the 44th US President, who had a white mother and a black father, should be classified as “Black”; and that Latino is an ethnicity, rather than a race <span class="citation" data-cites="Mattson2017">[@Mattson2017]</span>. The classification task may seem objective, but, perhaps unthinkingly, echoes the views of Americans with a certain class and background.</p>
<p>This is just one specific concern about one part of the <span class="citation" data-cites="wang2018deep">@wang2018deep</span> workflow. Broader concerns are raised by others including <span class="citation" data-cites="Gelman_2018">@Gelman_2018</span>. The main issue is that statistical models are specific to the data on which they were trained. And the only reason that we can identify likely issues in the model of <span class="citation" data-cites="wang2018deep">@wang2018deep</span> is because, despite not releasing the specific dataset that they used, they were nonetheless open about their procedure. For our work to be credible, it needs to be reproducible by others.</p>
</section>
<section id="section-2" class="level2">
<h2 class="anchored" data-anchor-id="section-2"></h2>
<p>Some of the steps that we can take to make our work more reproducible include:</p>
<ol type="1">
<li>Ensure the entire workflow is documented. This may involve addressing questions such as:
<ul>
<li>How was the original, unedited dataset obtained and is access likely to be persistent and available to others?</li>
<li>What specific steps are being taken to transform the original, unedited data into the data that were analyzed, and how can this be made available to others?</li>
<li>What analysis has been done, and how clearly can this be shared?</li>
<li>How has the final paper or report been built and to what extent can others follow that process themselves?</li>
</ul></li>
<li>Not worrying about perfect reproducibility initially, but instead focusing on trying to improve with each successive project. For instance, each of the following requirements are increasingly more onerous and there is no need to be concerned about not being able to do the last, until you can do the first:
<ul>
<li>Can you run your entire workflow again?</li>
<li>Can another person run your entire workflow again?</li>
<li>Can “future-you” run your entire workflow again?</li>
<li>Can “future-another-person” run your entire workflow again?</li>
</ul></li>
<li>Including a detailed discussion about the limitations of the dataset and the approach in the final paper or report.</li>
</ol>
</section>
<section id="section-3" class="level2">
<h2 class="anchored" data-anchor-id="section-3"></h2>
<p>The workflow that we advocate in this book is:</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
  p[[Plan]]
  sim[[Simulate]]
  a[[Acquire]]
  e[[Explore/Understand]]
  s[[Share]]

  p --&gt; sim --&gt; a --&gt; e --&gt; s
</pre>
</div>
<p></p><figcaption> Rohan Alexander’s <span class="citation" data-cites="alexander2023telling">[-@alexander2023telling]</span> <strong>Telling Stories with Data</strong> workflow</figcaption> </figure><p></p>
</div>
</div>
</div>
<!-- 
$$
\mbox{Plan}\rightarrow\mbox{Simulate}\rightarrow\mbox{Acquire}\rightarrow\mbox{Explore}\rightarrow\mbox{Share}
$$
 -->
<p>But it can be alternatively considered as: “<strong>Think an awful lot, mostly read and write, sometimes code</strong>”.</p>
</section>
<section id="section-4" class="level2">
<h2 class="anchored" data-anchor-id="section-4"></h2>
<p>There are various tools that we can use at the different stages that will improve the reproducibility of this workflow. This includes</p>
<ul>
<li>Quarto,</li>
<li>R Projects</li>
<li>Git and GitHub</li>
</ul>
</section>
<section id="quarto" class="level2">
<h2 class="anchored" data-anchor-id="quarto">Quarto</h2>
<section id="getting-started" class="level3">
<h3 class="anchored" data-anchor-id="getting-started">Getting started</h3>
<p>Quarto integrates code and natural language in a way that is called “literate programming” <span class="citation" data-cites="Knuth1984">[@Knuth1984]</span>. It is the successor to R Markdown, which was a variant of Markdown specifically designed to allow R code chunks to be included. Quarto uses a mark-up language similar to HyperText Markup Language (HTML) or LaTeX, in comparison to a “What You See Is What You Get” (WYSIWYG) language, such as Microsoft Word. This means that all the aspects are consistent, for instance, all top-level headings will look the same. But it means that we must designate or “mark up” how we would like certain aspects to appear. And it is only when we render the document that we get to see what it looks like. A visual editor option can also be used, and this hides the need for the user to do this mark-up themselves.</p>
</section>
</section>
<section id="section-5" class="level2">
<h2 class="anchored" data-anchor-id="section-5"></h2>
<p>One advantage of literate programming is that we get a “live” document in which code executes and then forms part of the document. Another advantage of Quarto is that similar code can compile into a variety of documents, including HTML and PDFs. Quarto also has default options for including a title, author, and date. One disadvantage is that it can take a while for a document to compile because the code needs to run.</p>
<p>We need to download Quarto from <a href="https://quarto.org/docs/get-started/">here</a>. (Skip this step if you are using Posit Cloud because it is already installed.) We can then create a new Quarto document within RStudio: “File” <span class="math inline">\(\rightarrow\)</span> “New File” <span class="math inline">\(\rightarrow\)</span> “Quarto Document<span class="math inline">\(\dots\)</span>”.</p>
<p>After opening a new Quarto document and selecting “Source” view, you will see the default <a href="#Top%20matter">top matter</a>, contained within a pair of three dashes, as well as some examples of text showing a few of the markdown <a href="#essential%20commands">essential commands</a> and <a href="#R%20chunks">R chunks</a>, each of which are discussed further in the following sections.</p>
</section>
<section id="section-6" class="level2">
<h2 class="anchored" data-anchor-id="section-6"></h2>
<section id="top-matter" class="level3">
<h3 class="anchored" data-anchor-id="top-matter">Top matter</h3>
<p>Top matter consists of defining aspects such as the title, author, and date. It is contained within three dashes at the top of a Quarto document. For instance, the following would specify a title, a date that automatically updated to the date the document was rendered, and an author.</p>
<pre><code>---
title: "My document"
author: "Rohan Alexander"
date: format(Sys.time(), "%d %B %Y")
format: html
---</code></pre>
</section>
</section>
<section id="section-7" class="level2">
<h2 class="anchored" data-anchor-id="section-7"></h2>
<p>An abstract is a short summary of the paper, and we could add that to the top matter.</p>
<pre><code>---
title: "My document"
author: "Rohan Alexander"
date: format(Sys.time(), "%d %B %Y")
abstract: "This is my abstract."
format: html
---</code></pre>
</section>
<section id="section-8" class="level2">
<h2 class="anchored" data-anchor-id="section-8"></h2>
<p>By default, Quarto will create an HTML document, but we can change the output format to produce a PDF. This uses LaTeX in the background and requires the installation of supporting packages. To do this install <code>tinytex</code>. But as it is used in the background we should not need to load it.</p>
<pre><code>---
title: "My document"
author: "Rohan Alexander"
date: format(Sys.time(), "%d %B %Y")
abstract: "This is my abstract."
format: pdf
---</code></pre>
</section>
<section id="section-9" class="level2">
<h2 class="anchored" data-anchor-id="section-9"></h2>
<p>We can include references by specifying a BibTeX file in the top matter and then calling it within the text, as needed.</p>
<pre><code>---
title: "My document"
author: "Rohan Alexander"
date: format(Sys.time(), "%d %B %Y")
format: pdf
abstract: "This is my abstract."
bibliography: bibliography.bib
---</code></pre>
</section>
<section id="section-10" class="level2">
<h2 class="anchored" data-anchor-id="section-10"></h2>
<p>We would need to make a separate file called “bibliography.bib” and save it next to the Quarto file. In the BibTeX file we need an entry for the item that is to be referenced. For instance, the citation for R can be obtained with <code>citation()</code> and this can be added to the “bibliography.bib” file. The citation for a package can be found by including the package name, for instance <code>citation("tidyverse")</code>, and again adding the output to the “.bib” file. It can be helpful to use <a href="https://scholar.google.com">Google Scholar</a> or <a href="https://www.doi2bib.org">doi2bib</a> to get citations for books or articles.</p>
</section>
<section id="section-11" class="level2">
<h2 class="anchored" data-anchor-id="section-11"></h2>
<p>We need to create a unique key that we use to refer to this item in the text. This can be anything, provided it is unique, but meaningful ones can be easier to remember, for instance “citeR”.</p>
<pre><code>@Manual{citeR,
    title = {R: A Language and Environment for Statistical Computing},
    author = {{R Core Team}},
    organization = {R Foundation for Statistical Computing},
    address = {Vienna, Austria},
    year = {2021},
    url = {https://www.R-project.org/},
  }
@book{tellingstories,
    title = {Telling Stories with Data},
    author = {Rohan Alexander},
    year = {2023},
    publisher = {Chapman and Hall/CRC},
    url = {https://tellingstorieswithdata.com}
  }</code></pre>
</section>
<section id="section-12" class="level2">
<h2 class="anchored" data-anchor-id="section-12"></h2>
<p>To cite R in the Quarto document we then include <code>@citeR</code>, which would put brackets around the year: <span class="citation" data-cites="citeR">@citeR</span>, or <code>[@citeR]</code>, which would put brackets around the whole thing: <span class="citation" data-cites="citeR">[@citeR]</span>.</p>
</section>
<section id="section-13" class="level2">
<h2 class="anchored" data-anchor-id="section-13"></h2>
<p>The reference list at the end of the paper is automatically built based on calling the BibTeX file and including references in the paper. At the end of the Quarto document, include a heading “# References” and the actual citations will be included after that. When the Quarto file is rendered, Quarto sees these in the content, goes to the BibTeX file to get the reference details that it needs, builds the reference list, and then adds it at the end of the rendered document.</p>
</section>
<section id="section-14" class="level2">
<h2 class="anchored" data-anchor-id="section-14"></h2>
<section id="essential-commands" class="level3">
<h3 class="anchored" data-anchor-id="essential-commands">Essential commands</h3>
<p>Quarto uses a variation of Markdown as its underlying syntax. Essential Markdown commands include those for emphasis, headers, lists, links, and images. A reminder of these is included in RStudio: “Help” <span class="math inline">\(\rightarrow\)</span> “Markdown Quick Reference”. It is your choice as to whether you want to use the visual or source editor. But either way, it is good to understand these essentials because it will not always be possible to use a visual editor (for instance if you are quickly looking at a Quarto document in GitHub). As you get more experience it can be useful to use a text editor such as Sublime Text, or an alternative Integrated Development Environment such as VS Code.</p>
<ul>
<li>Emphasis: <code>*italic*</code>, <code>**bold**</code></li>
<li>Headers (these go on their own line with a blank line before and after):</li>
</ul>
<pre><code>         # First level header
         
         ## Second level header
         
         ### Third level header</code></pre>
<ul>
<li>Unordered list, with sub-lists:</li>
</ul>
<pre><code>    * Item 1
    * Item 2
        + Item 2a
        + Item 2b</code></pre>
<ul>
<li>Ordered list, with sub-lists:</li>
</ul>
<pre><code>    1. Item 1
    2. Item 2
    3. Item 3
        + Item 3a
        + Item 3b</code></pre>
<ul>
<li>URLs can be added: <code>[this book](https://www.tellingstorieswithdata.com)</code> results in <a href="https://www.tellingstorieswithdata.com">this book</a>.</li>
<li>A paragraph is created by leaving a blank line.</li>
</ul>
<pre><code>A paragraph about an idea, nicely spaced from the following paragraph.

A paragraph about another idea, again spaced from the earlier paragraph.</code></pre>
</section>
</section>
<section id="section-15" class="level2">
<h2 class="anchored" data-anchor-id="section-15"></h2>
<p>Once we have added some aspects, then we may want to see the actual document. To build the document click “Render”.</p>
</section>
<section id="section-16" class="level2">
<h2 class="anchored" data-anchor-id="section-16"></h2>
<section id="r-chunks" class="level3">
<h3 class="anchored" data-anchor-id="r-chunks">R chunks</h3>
<p>We can include code for R and many other languages in code chunks within a Quarto document. When we render the document the code will run and be included in the document.</p>
<p>To create an R chunk, we start with three backticks and then within curly braces we tell Quarto that this is an R chunk. Anything inside this chunk will be considered R code and run as such. We use data from <span class="citation" data-cites="citeaer">@citeaer</span> who provide the R package <code>AER</code> to accompany their book <em>Applied Econometrics with R</em>. We could load the <code>tidyverse</code> and install and load <code>AER</code> and make a graph of the number of times a survey respondent visited the doctor in the past two weeks.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>```{r}</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>library(tidyverse)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>library(AER)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>data("DoctorVisits", package = "AER")</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>DoctorVisits |&gt;</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  ggplot(aes(x = illness)) +</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  geom_histogram(stat = "count")</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>```</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="section-17" class="level2">
<h2 class="anchored" data-anchor-id="section-17"></h2>
<p>The output of that code is <a href="#fig-doctervisits" class="quarto-xref">Figure&nbsp;1</a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-doctervisits" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-doctervisits-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lecture-05-content_files/figure-html/fig-doctervisits-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-doctervisits-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Number of illnesses in the past two weeks, based on the 1977–1978 Australian Health Survey
</figcaption>
</figure>
</div>
</div>
</div>
<p>There are various evaluation options that are available in chunks. We include these, each on a new line, by opening the line with the chunk-specific comment delimiter “#|” and then the option. Helpful options include:</p>
<ul>
<li><code>echo</code>: This controls whether the code itself is included in the document. For instance, <code>#| echo: false</code> would mean the code will be run and its output will show, but the code itself would not be included in the document.</li>
<li><code>include</code>: This controls whether the output of the code is included in the document. For instance, <code>#| include: false</code> would run the code, but would not result in any output, and the code itself would not be included in the document.</li>
<li><code>eval</code>: This controls whether the code should be included in the document. For instance, <code>#| eval: false</code> would mean that the code is not run, and hence there would not be any output to include, but the code itself would be included in the document.</li>
<li><code>warning</code>: This controls whether warnings should be included in the document. For instance, <code>#| warning: false</code> would mean that warnings are not included.</li>
<li><code>message</code>: This controls whether messages should be included in the document. For instance, <code>#| message: false</code> would mean that messages are not included in the document.</li>
</ul>
<p>For instance, we could include the output, but not the code, and suppress any warnings.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>```{r}</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>#| echo: false</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>#| warning: false</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>library(tidyverse)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>library(AER)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>data("DoctorVisits", package = "AER")</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>DoctorVisits |&gt;</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  ggplot(aes(x = visits)) +</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  geom_histogram(stat = "count")</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>```</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Leave a blank line on either side of an R chunk, otherwise it may not run properly. And use lower case for logical values, i.e.&nbsp;“false” not “FALSE”.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>Most people did not visit a doctor in the past week.</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>```{r}</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>#| echo: false</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>#| eval: false</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>#| warning: false</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>library(tidyverse)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>library(AER)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>data("DoctorVisits", package = "AER")</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>DoctorVisits |&gt;</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  ggplot(aes(x = visits)) +</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  geom_histogram(stat = "count")</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>There were some people that visited a doctor once, and then...</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The Quarto document itself must load any datasets that are needed. It is not enough that they are in the environment. This is because the Quarto document evaluates the code in the document when it is rendered, not necessarily the environment.</p>
<section id="sec-equations" class="level3">
<h3 class="anchored" data-anchor-id="sec-equations">Equations</h3>
<p>We can include equations by using LaTeX, which is based on the programming language TeX. We invoke math mode in LaTeX by using two dollar signs as opening and closing tags. Then whatever is inside is evaluated as LaTeX mark-up. For instance we can produce the compound interest formula with:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>A = P\left(1+\frac{r}{n}\right)^{nt}</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>$$</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[
A = P\left(1+\frac{r}{n}\right)^{nt}
\]</span></p>
</section>
</section>
<section id="section-18" class="level2">
<h2 class="anchored" data-anchor-id="section-18"></h2>
<p>LaTeX is a comprehensive mark-up language but we will mostly just use it to specify the model of interest. We include some examples here that contain the critical aspects we will draw on starting in <strong>?@sec-its-just-a-linear-model</strong>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>y_i|\mu_i, \sigma \sim \mbox{Normal}(\mu_i, \sigma)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>$$</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[
y_i|\mu_i, \sigma \sim \mbox{Normal}(\mu_i, \sigma)
\]</span></p>
</section>
<section id="section-19" class="level2">
<h2 class="anchored" data-anchor-id="section-19"></h2>
<p>Underscores are used to get subscripts: <code>y_i</code> for <span class="math inline">\(y_i\)</span>. And we can get a subscript of more than one item by surrounding it with curly braces: <code>y_{i,c}</code> for <span class="math inline">\(y_{i,c}\)</span>. In this case we wanted math mode within the line, and so we surround these with only one dollar sign as opening and closing tags.</p>
<p>Greek letters are typically preceded by a backslash. Common Greek letters include: <code>\alpha</code> for <span class="math inline">\(\alpha\)</span>, <code>\beta</code> for <span class="math inline">\(\beta\)</span>, <code>\delta</code> for <span class="math inline">\(\delta\)</span>, <code>\epsilon</code> for <span class="math inline">\(\epsilon\)</span>, <code>\gamma</code> for <span class="math inline">\(\gamma\)</span>, <code>\lambda</code> for <span class="math inline">\(\lambda\)</span>, <code>\mu</code> for <span class="math inline">\(\mu\)</span>, <code>\phi</code> for <span class="math inline">\(\phi\)</span>, <code>\pi</code> for <span class="math inline">\(\pi\)</span>, <code>\Pi</code> for <span class="math inline">\(\Pi\)</span>, <code>\rho</code> for <span class="math inline">\(\rho\)</span>, <code>\sigma</code> for <span class="math inline">\(\sigma\)</span>, <code>\Sigma</code> for <span class="math inline">\(\Sigma\)</span>, <code>\tau</code> for <span class="math inline">\(\tau\)</span>, and <code>\theta</code> for <span class="math inline">\(\theta\)</span>.</p>
</section>
<section id="section-20" class="level2">
<h2 class="anchored" data-anchor-id="section-20"></h2>
<p>LaTeX math mode assumes letters are variables and so makes them italic, but sometimes we want a word to appear in normal font because it is not a variable, such as “Normal”. In that case we surround it with <code>\mbox{}</code>, for instance <code>\mbox{Normal}</code> for <span class="math inline">\(\mbox{Normal}\)</span>.</p>
</section>
<section id="section-21" class="level2">
<h2 class="anchored" data-anchor-id="section-21"></h2>
<p>We line up equations across multiple lines using <code>\begin{aligned}</code> and <code>\end{aligned}</code>. Then the item that is to be lined up is noted by an ampersand. The following is a model that we will estimate in <strong>?@sec-multilevel-regression-with-post-stratification</strong>.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>y_i|\pi_i &amp; \sim \mbox{Bern}(\pi_i) <span class="sc">\\</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>\mbox{logit}(\pi_i) &amp; = \beta_0+ \alpha_{g<span class="co">[</span><span class="ot">i</span><span class="co">]</span>}^{\mbox{gender}} + \alpha_{a<span class="co">[</span><span class="ot">i</span><span class="co">]</span>}^{\mbox{age}} + \alpha_{s<span class="co">[</span><span class="ot">i</span><span class="co">]</span>}^{\mbox{state}} + \alpha_{e<span class="co">[</span><span class="ot">i</span><span class="co">]</span>}^{\mbox{edu}} <span class="sc">\\</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>\beta_0 &amp; \sim \mbox{Normal}(0, 2.5)<span class="sc">\\</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>\alpha_{g}^{\mbox{gender}} &amp; \sim \mbox{Normal}(0, 2.5)\mbox{ for }g=1, 2<span class="sc">\\</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>\alpha_{a}^{\mbox{age}} &amp; \sim \mbox{Normal}\left(0, \sigma^2_{\mbox{age}}\right)\mbox{ for }a = 1, 2, \dots, A<span class="sc">\\</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>\alpha_{s}^{\mbox{state}} &amp; \sim \mbox{Normal}\left(0, \sigma^2_{\mbox{state}}\right)\mbox{ for }s = 1, 2, \dots, S<span class="sc">\\</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>\alpha_{e}^{\mbox{edu}} &amp; \sim \mbox{Normal}\left(0, \sigma^2_{\mbox{edu}}\right)\mbox{ for }e = 1, 2, \dots, E<span class="sc">\\</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>\sigma_{\mbox{gender}} &amp; \sim \mbox{Exponential}(1)<span class="sc">\\</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>\sigma_{\mbox{state}} &amp; \sim \mbox{Exponential}(1)<span class="sc">\\</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>\sigma_{\mbox{edu}} &amp; \sim \mbox{Exponential}(1)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>$$</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[
\begin{aligned}
y_i|\pi_i &amp; \sim \mbox{Bern}(\pi_i) \\
\mbox{logit}(\pi_i) &amp; = \beta_0+ \alpha_{g[i]}^{\mbox{gender}} + \alpha_{a[i]}^{\mbox{age}} + \alpha_{s[i]}^{\mbox{state}} + \alpha_{e[i]}^{\mbox{edu}} \\
\beta_0 &amp; \sim \mbox{Normal}(0, 2.5)\\
\alpha_{g}^{\mbox{gender}} &amp; \sim \mbox{Normal}(0, 2.5)\mbox{ for }g=1, 2\\
\alpha_{a}^{\mbox{age}} &amp; \sim \mbox{Normal}\left(0, \sigma^2_{\mbox{age}}\right)\mbox{ for }a = 1, 2, \dots, A\\
\alpha_{s}^{\mbox{state}} &amp; \sim \mbox{Normal}\left(0, \sigma^2_{\mbox{state}}\right)\mbox{ for }s = 1, 2, \dots, S\\
\alpha_{e}^{\mbox{edu}} &amp; \sim \mbox{Normal}\left(0, \sigma^2_{\mbox{edu}}\right)\mbox{ for }e = 1, 2, \dots, E\\
\sigma_{\mbox{gender}} &amp; \sim \mbox{Exponential}(1)\\
\sigma_{\mbox{state}} &amp; \sim \mbox{Exponential}(1)\\
\sigma_{\mbox{edu}} &amp; \sim \mbox{Exponential}(1)
\end{aligned}
\]</span></p>
</section>
<section id="section-22" class="level2">
<h2 class="anchored" data-anchor-id="section-22"></h2>
<p>Finally, certain functions are built into LaTeX. For instance, we can appropriately typeset “log” with <code>\log</code>.</p>
</section>
<section id="section-23" class="level2">
<h2 class="anchored" data-anchor-id="section-23"></h2>
<section id="sec-quartocrossreferences" class="level3">
<h3 class="anchored" data-anchor-id="sec-quartocrossreferences">Cross-references</h3>
<p>It can be useful to cross-reference figures, tables, and equations. This makes it easier to refer to them in the text. To do this for a figure we refer to the name of the R chunk that creates or contains the figure. For instance, consider the following code.</p>
</section>
</section>
<section id="section-24" class="level2">
<h2 class="anchored" data-anchor-id="section-24"></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-uniquename</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: Number of illnesses in the past two weeks, based on the 1977--1978 Australian Health Survey</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="in">#| warning: false</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="in">data("DoctorVisits", package = "AER")</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="in">DoctorVisits |&gt;</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="in">    ggplot(aes(x = illness)) +</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_histogram(stat = "count")</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-uniquename" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-uniquename-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lecture-05-content_files/figure-html/fig-uniquename-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-uniquename-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Number of illnesses in the past two weeks, based on the 1977–1978 Australian Health Survey
</figcaption>
</figure>
</div>
</div>
</div>
<p>Then <code>(@fig-uniquename)</code> would produce: (<a href="#fig-uniquename" class="quarto-xref">Figure&nbsp;2</a>) as the name of the R chunk is <code>fig-uniquename</code>. We need to add “fig” to the start of the chunk name so that Quarto knows that this is a figure. We then include a “fig-cap:” in the R chunk that specifies a caption.</p>
</section>
<section id="section-25" class="level2">
<h2 class="anchored" data-anchor-id="section-25"></h2>
<p>We can add <code>#| layout-ncol: 2</code> in an R chunk within a Quarto document to have two graphs appear side by side (<a href="#fig-doctorgraphsidebyside" class="quarto-xref">Figure&nbsp;3</a>). Here <a href="#fig-doctorgraphsidebyside-1" class="quarto-xref">Figure&nbsp;3 (a)</a> uses the minimal theme, and <a href="#fig-doctorgraphsidebyside-2" class="quarto-xref">Figure&nbsp;3 (b)</a> uses the classic theme. These both cross-reference the same label <code>#| label: fig-doctorgraphsidebyside</code> in the R chunk, with an additional option added in the R chunk of <code>#| fig-subcap: ["Number of illnesses","Number of visits to the doctor"]</code> which provides the sub-captions. The addition of a letter in-text is accomplished by adding “-1” and “-2” to the end of the label when it is used in-text: <code>(@fig-doctorgraphsidebyside)</code>, <code>@fig-doctorgraphsidebyside-1</code>, and <code>@fig-doctorgraphsidebyside-2</code> for (<a href="#fig-doctorgraphsidebyside" class="quarto-xref">Figure&nbsp;3</a>), <a href="#fig-doctorgraphsidebyside-1" class="quarto-xref">Figure&nbsp;3 (a)</a>, and <a href="#fig-doctorgraphsidebyside-2" class="quarto-xref">Figure&nbsp;3 (b)</a>, respectively.</p>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="in">#| eval: true</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="in">#| warning: false</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-doctorgraphsidebyside</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Two variants of graphs"</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-subcap: ["Illnesses","Visits to the doctor"]</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="in">#| layout-ncol: 2</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="in">DoctorVisits |&gt;</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="in">    ggplot(aes(x = illness)) +</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_histogram(stat = "count") +</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="in">    theme_minimal()</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="in">DoctorVisits |&gt;</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="in">    ggplot(aes(x = visits)) +</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_histogram(stat = "count") +</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="in">    theme_classic()</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-doctorgraphsidebyside" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-doctorgraphsidebyside-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-doctorgraphsidebyside" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-doctorgraphsidebyside-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-doctorgraphsidebyside-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lecture-05-content_files/figure-html/fig-doctorgraphsidebyside-1.png" class="img-fluid figure-img" data-ref-parent="fig-doctorgraphsidebyside" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-doctorgraphsidebyside-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Illnesses
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-doctorgraphsidebyside" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-doctorgraphsidebyside-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-doctorgraphsidebyside-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lecture-05-content_files/figure-html/fig-doctorgraphsidebyside-2.png" class="img-fluid figure-img" data-ref-parent="fig-doctorgraphsidebyside" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-doctorgraphsidebyside-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Visits to the doctor
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-doctorgraphsidebyside-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Two variants of graphs
</figcaption>
</figure>
</div>
</section>
<section id="section-26" class="level2">
<h2 class="anchored" data-anchor-id="section-26"></h2>
<p>We can take a similar approach to cross-reference tables. For instance, <code>(@tbl-docvisittable)</code> will produce: (<a href="#tbl-docvisittable" class="quarto-xref">Table&nbsp;1</a>). In this case we specify “tbl” at the start of the label so that Quarto knows that it is a table. And we specify a caption for the table with “tbl-cap:”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: tbl-docvisittable</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="in">#| tbl-cap: "Distribution of the number of doctor visits"</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="in">DoctorVisits |&gt;</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="in">    count(visits) |&gt;</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="in">    kable()</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-docvisittable" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-docvisittable-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Distribution of the number of doctor visits
</figcaption>
<div aria-describedby="tbl-docvisittable-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">visits</th>
<th style="text-align: right;">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">4141</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">782</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">174</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">30</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">24</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="odd">
<td style="text-align: right;">8</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="section-27" class="level2">
<h2 class="anchored" data-anchor-id="section-27"></h2>
<p>Finally, we can also cross-reference equations. To that we need to add a tag such as <code>{#eq-macroidentity}</code> which we then reference.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>Y = C + I + G + (X - M)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>$$ {#eq-gdpidentity}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For instance, we then use <code>@eq-gdpidentity</code> to produce <a href="#eq-gdpidentity" class="quarto-xref">Equation&nbsp;1</a></p>
<p><span id="eq-gdpidentity"><span class="math display">\[
Y = C + I + G + (X - M)
\tag{1}\]</span></span></p>
<p>Labels should be relatively simple when using cross-references. In general, try to keep the names simple but unique, avoid punctuation, and stick to letters and hyphens. Try not to use underscores, because they can cause an error.</p>
</section>
<section id="r-projects-and-file-structure" class="level2">
<h2 class="anchored" data-anchor-id="r-projects-and-file-structure">R Projects and file structure</h2>
<p>Projects are widely used in software development and exist to keep all the files (data, analysis, report, etc) associated with a particular project together and related to each other. (This use of “project” in a software development sense, is distinct to a “project”, in the project management sense.) An R Project can be created in RStudio. Click “File” <span class="math inline">\(\rightarrow\)</span> “New Project”, then select “Empty project”, name the R Project and decide where to save it. For instance, a R Project focused on maternal mortality may be called “maternalmortality”. The use of R Projects enables “reliable, polite behavior across different computers or users and over time” <span class="citation" data-cites="whattheyforgot">[@whattheyforgot]</span>. This is because they remove the context of that folder from its broader existence; files exist in relation to the base of the R Project, not the base of the computer.</p>
</section>
<section id="section-28" class="level2">
<h2 class="anchored" data-anchor-id="section-28"></h2>
<p>Once a project has been created, a new file with the extension “.RProj” will appear in that folder. An example of a folder with an R Project, a Quarto document, and an appropriate file structure is available <a href="https://github.com/RohanAlexander/starter_folder">here</a>. That can be downloaded: “Code” <span class="math inline">\(\rightarrow\)</span> “Download ZIP”.</p>
<p>The main advantage of using an R Project is that we can reference files within it in a self-contained way. That means when others want to reproduce our work, they will not need to change all the file references and structure as everything is referenced in relation to the “.Rproj” file. For instance, instead of reading a CSV from, say, <code>"~/Documents/projects/book/data/"</code> you can read it from <code>book/data/</code>. It may be that someone else does not have a <code>projects</code> folder, and so the former would not work for them, while the latter would.</p>
</section>
<section id="section-29" class="level2">
<h2 class="anchored" data-anchor-id="section-29"></h2>
<p>The use of projects is required to meet the minimal level of reproducibility expected of credible work. The use of functions such as <code>setwd()</code>, and computer-specific file paths, bind work to a specific computer in a way that is not appropriate.</p>
<p>There are a variety of ways to set up a folder. A variant of <span class="citation" data-cites="wilsongoodenough">@wilsongoodenough</span> that is often useful when you are getting started is shown in the example file structure linked above.</p>
</section>
<section id="section-30" class="level2">
<h2 class="anchored" data-anchor-id="section-30"></h2>
<pre class="text"><code>example_project/
├── .gitignore
├── LICENSE.md
├── README.md
├── example_project.Rproj
├── inputs
│   ├── data
│   │   ├── unedited_data.csv
│   │   └── ...
│   ├── literature
│   │   ├── alexander-tellingstorieswithdata.pdf
│   │   ├── gelman-xboxpaper.pdf
│   │   └── ...
├── outputs
│   ├── README.md
│   ├── data
│   │   ├── analysis_data.csv
│   │   └── ...
│   ├── paper
│   │   ├── paper.pdf
│   │   ├── paper.qmd
│   │   ├── references.bib
│   │   └── ...
│   └── ...
├── scripts
│   ├── 00-simulate_data.R
│   ├── 01-download_data.R
│   ├── 02-data_cleaning.R
│   ├── 03-test_data.R
│   └── ...
└── ...</code></pre>
<p>Here we have an <code>inputs</code> folder that contains original, unedited data that should not be written over <span class="citation" data-cites="wilsongoodenough">[@wilsongoodenough]</span> and literature related to the project. An <code>outputs</code> folder contains data that we create using R, as well as the paper that we are writing. And a <code>scripts</code> folder is what modifies the unedited data and saves it into <code>outputs</code>. We will do most of our work in “scripts”, and the Quarto file for the paper in <code>outputs</code>. Useful other aspects include a <code>README.md</code> which will specify overview details about the project, and a LICENSE. An example of what to put in the README is <a href="https://social-science-data-editors.github.io/template_README/">here</a>. Another helpful variant of this project skeleton is provided by <span class="citation" data-cites="GoodResearchCode">@GoodResearchCode</span>.</p>
</section>
<section id="section-31" class="level2">
<h2 class="anchored" data-anchor-id="section-31"></h2>
</section>
</section>
<section id="version-control" class="level1">
<h1><i class="bi-github " style="" role="img" aria-hidden="true"></i> Version Control</h1>
<section id="section-32" class="level2">
<h2 class="anchored" data-anchor-id="section-32"></h2>
<p>In this book we implement version control through a combination of Git and GitHub. There are a variety of reasons for this including:</p>
<ol type="1">
<li>enhancing the reproducibility of work by making it easier to share code and data;</li>
<li>making it easier to share work;</li>
<li>improving workflow by encouraging systematic approaches; and</li>
<li>making it easier to work in teams.</li>
</ol>
</section>
<section id="section-33" class="level2">
<h2 class="anchored" data-anchor-id="section-33"></h2>
<p>Git is a version control system with a fascinating history <span class="citation" data-cites="githistory">[@githistory]</span>. The way one often starts doing version control is to have various copies of the one file: “first_go.R”, “first_go-fixed.R”, “first_go-fixed-with-mons-edits.R”. But this soon becomes cumbersome. One often soon turns to dates, for instance: “2022-01-01-analysis.R”, “2022-01-02-analysis.R”, “2022-01-03-analysis.R”, etc. While this keeps a record, it can be difficult to search when we need to go back, because it is hard to remember the date some change was made. In any case, it quickly gets unwieldy for a project that is being regularly worked on.</p>
</section>
<section id="section-34" class="level2">
<h2 class="anchored" data-anchor-id="section-34"></h2>
<p>Instead of this, we use Git so that we can have one version of the file. Git keeps a record of the changes to that file, and a snapshot of that file at a given point in time. We determine when Git takes that snapshot. We additionally include a message saying what changed between this snapshot and the last. In that way, there is only ever one version of the file, and the history can be more easily searched.</p>
</section>
<section id="section-35" class="level2">
<h2 class="anchored" data-anchor-id="section-35"></h2>
<p>One complication is that Git was designed for teams of software developers. As such, while it works, it can be a little ungainly for non-developers. Nonetheless Git has been usefully adapted for data science, even when the only collaborator one may have is one’s future self <span class="citation" data-cites="Bryan2018">[@Bryan2018]</span>.</p>
<p>GitHub, GitLab, and various other companies offer easier-to-use services that build on Git. While there are tradeoffs, we introduce GitHub here because it is the predominant platform <span class="citation" data-cites="eghbal2020working">[@eghbal2020working, p. 21]</span>. Git and GitHub are built into Posit Cloud, which provides a nice option if you have issues with local installation. One of the initial challenging aspects of Git is the terminology. Folders are called “repos”. Creating a snapshot is called a “commit”. One gets used to it eventually, but feeling confused initially is normal. <span class="citation" data-cites="happygit">@happygit</span> is especially useful for setting up and using Git and GitHub.</p>
</section>
<section id="section-36" class="level2">
<h2 class="anchored" data-anchor-id="section-36"></h2>
<section id="git" class="level3">
<h3 class="anchored" data-anchor-id="git">Git</h3>
<p>We first need to check whether Git is installed. Open RStudio, go to the Terminal, type the following, and then enter/return.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> <span class="at">--version</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If you get a version number, then you are done (<a href="#fig-gitone" class="quarto-xref">Figure&nbsp;4 (a)</a>).</p>
<div id="fig-grits" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-grits-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-grits" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-gitone" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-gitone-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/03-git-setup-01.png" class="img-fluid figure-img" data-ref-parent="fig-grits">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-gitone-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Using Terminal to check whether Git is installed in RStudio
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-grits" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-gitone-setup" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-gitone-setup-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/03-git-setup-02.png" class="img-fluid figure-img" data-ref-parent="fig-grits">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-gitone-setup-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Adding a username and email address to Git in RStudio
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-grits-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: An overview of the steps involved in setting up Git
</figcaption>
</figure>
</div>
</section>
</section>
<section id="section-37" class="level2">
<h2 class="anchored" data-anchor-id="section-37"></h2>
<p>Git is pre-installed in Posit Cloud, it should be pre-installed on Mac, and it may be pre-installed on Windows. If you do not get a version number in response, then you need to install it. To do that you should follow the instructions specific to your operating system in <span class="citation" data-cites="happygit">@happygit [Chapter 5]</span>.</p>
<p>After Git is installed we need to tell it a username and email. We need to do this because Git adds this information whenever we take a snapshot, or to use Git’s language, whenever we make a commit.</p>
</section>
<section id="section-38" class="level2">
<h2 class="anchored" data-anchor-id="section-38"></h2>
<p>Again, within the Terminal, type the following, replacing the details with yours, and then press “enter/return” after each line.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> config <span class="at">--global</span> user.name <span class="st">"Rohan Alexander"</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> config <span class="at">--global</span> user.email <span class="st">"rohan.alexander@utoronto.ca"</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> config <span class="at">--global</span> <span class="at">--list</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>When this set-up has been done properly, the values that you entered for “user.name” and “user.email” will be returned after the last line (<a href="#fig-gitone-setup" class="quarto-xref">Figure&nbsp;4 (b)</a>).</p>
<p>These details—username and email address—will be public. There are various ways to hide the email address if necessary, and GitHub provides instructions about this. <span class="citation" data-cites="happygit">@happygit [Chapter 7]</span> provides more detailed instructions about this step, and a trouble-shooting guide.</p>
</section>
<section id="section-39" class="level2">
<h2 class="anchored" data-anchor-id="section-39"></h2>
<section id="github" class="level3">
<h3 class="anchored" data-anchor-id="github">GitHub</h3>
<p>Now that Git is set up, we need to set up GitHub. We created a GitHub account in <strong>?@sec-fire-hose</strong>, which we use again here. After being signed in at <code>github.com</code> we first need to make a new folder, which is called a “repo” in Git. Look for a “+” in the top right, and then select “New Repository” (<a href="#fig-githubtwo" class="quarto-xref">Figure&nbsp;5 (a)</a>).</p>
<div id="fig-gritshub" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gritshub-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-gritshub" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-githubtwo" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-githubtwo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/github_2.png" class="img-fluid figure-img" data-ref-parent="fig-gritshub">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-githubtwo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Start process of creating a new repository
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-gritshub" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-githubfour" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-githubfour-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/github_4.png" class="img-fluid figure-img" data-ref-parent="fig-gritshub">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-githubfour-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Copy the URL of the new repository
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-gritshub" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-githubnewproject" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-githubnewproject-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/03-github-new-project.png" class="img-fluid figure-img" data-ref-parent="fig-gritshub">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-githubnewproject-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) Adding the project to Posit Cloud
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-gritshub" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-githubpat" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-githubpat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/04-githubpat.png" class="img-fluid figure-img" data-ref-parent="fig-gritshub">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-githubpat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(d) Creating a PAT
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-gritshub" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-githubadd" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-githubadd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/03-github-add.png" class="img-fluid figure-img" data-ref-parent="fig-gritshub">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-githubadd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(e) Adding files to be committed
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-gritshub" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-githubcommit" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-githubcommit-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/03-github-commit.png" class="img-fluid figure-img" data-ref-parent="fig-gritshub">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-githubcommit-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(f) Making a commit
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gritshub-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: An overview of the steps involved in setting up GitHub
</figcaption>
</figure>
</div>
</section>
</section>
<section id="section-40" class="level2">
<h2 class="anchored" data-anchor-id="section-40"></h2>
<p>At this point we can add a sensible name for the repo. Leave it as “public” for now, because it can always be deleted later. And check the box to “Initialize this repository with a README”. Change “Add .gitignore” to R. After that, click “Create repository”.</p>
<p>This will take us to a screen that is fairly empty, but the details that we need—a URL—are in the green “Clone or Download” button, which we can copy by clicking the clipboard (<a href="#fig-githubfour" class="quarto-xref">Figure&nbsp;5 (b)</a>).</p>
</section>
<section id="section-41" class="level2">
<h2 class="anchored" data-anchor-id="section-41"></h2>
<p>Now returning to RStudio, in Posit Cloud, we create a new project using “New Project from Git Repository”. It will ask for the URL that we just copied (<a href="#fig-githubnewproject" class="quarto-xref">Figure&nbsp;5 (c)</a>). If you are using a local computer, then this step is accomplished through the menu: “File” <span class="math inline">\(\rightarrow\)</span> “New Project…” <span class="math inline">\(\rightarrow\)</span> “Version Control” <span class="math inline">\(\rightarrow\)</span> “Git”, then paste in the URL, give the folder a meaningful name, check “Open in new session”, then click “Create Project”.</p>
</section>
<section id="section-42" class="level2">
<h2 class="anchored" data-anchor-id="section-42"></h2>
<p>At this point, a new folder has been created that we can use. We will want to be able to push it back to GitHub, and for that we will need to use a Personal Access Token (PAT) to link our RStudio Workspace with our GitHub account. We use <code>usethis</code> and <code>gitcreds</code> to enable this. These are, respectively, a package that automates repetitive tasks, and a package that authenticates with GitHub. To create a PAT, while signed into GitHub in the browser, and after installing and loading <code>usethis</code> run <code>create_github_token()</code> in your R session. GitHub will open in the browser with various options filled out (<a href="#fig-githubpat" class="quarto-xref">Figure&nbsp;5 (d)</a>). It can be useful to give the PAT an informative name by replacing “Note”, for instance “PAT for RStudio”, then click “Generate token”.</p>
</section>
<section id="section-43" class="level2">
<h2 class="anchored" data-anchor-id="section-43"></h2>
<p>We only have one chance to copy this token, and if we make a mistake then we will need to generate a new one. Do not include the PAT in any R script or Quarto document. Instead, after installing and loading <code>gitcreds</code>, run <code>gitcreds_set()</code>, which will then prompt you to add your PAT in the console.</p>
</section>
<section id="section-44" class="level2">
<h2 class="anchored" data-anchor-id="section-44"></h2>
<p>To use GitHub for a project that we are actively working on we follow this procedure:</p>
<ol type="1">
<li>The first thing to do is almost always to get any changes with “pull”. To do this, open the Git pane in RStudio, and click the blue down arrow. This gets any changes to the folder, as it is on GitHub, into our own version of the folder.</li>
<li>We can then make our changes to our copy of the folder. For instance, we could update the README, and then save it as normal.</li>
<li>Once this is done, we need to add, commit, and push. In the Git pane in RStudio, select the files to be added. This adds them to the staging area. Then click “Commit” (<a href="#fig-githubadd" class="quarto-xref">Figure&nbsp;5 (e)</a>). A new window will open. Add an informative message about the change that was made, and then click “Commit” in that new window (<a href="#fig-githubcommit" class="quarto-xref">Figure&nbsp;5 (f)</a>). Finally, click “Push” to send the changes to GitHub.</li>
</ol>
</section>
<section id="section-45" class="level2">
<h2 class="anchored" data-anchor-id="section-45"></h2>
<p>There are a few common pain-points when it comes to Git and GitHub. We recommend committing and pushing regularly, especially when you are new to version control. This increases the number of snapshots that you could come back to if needed. All commits should have an informative commit message. If you are new to version control, then the expectation of a good commit message is that it contains a short summary of the change, followed by a blank line, and then an explanation of the change including what the change is, and why it is being made. For instance, if your commit adds graphs to a paper, then a commit message could be:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>Add graphs</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>Graphs of unemployment and inflation added into Data section.</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="section-46" class="level2">
<h2 class="anchored" data-anchor-id="section-46"></h2>
<p>There is some evidence of a relationship between overall quality and commit behavior <span class="citation" data-cites="sprint2019mining">[@sprint2019mining]</span>. As you get more experience ideally the commit messages will act as a kind of journal of the project. But the main thing is to commit regularly.</p>
<p>Git and GitHub were designed for software developers, rather than data scientists. GitHub limits the size of the files it will consider to 100MB, and even 50MB can prompt a warning. Data science projects regularly involve datasets that are larger than this. In <strong>?@sec-store-and-share</strong> we discuss the use of data deposits, which can be especially useful when a project is completed, but when we are actively working on a project it can be useful to ignore large data files, at least as far as Git and GitHub are concerned. We do this using a “.gitignore” file, in which we list all of the files that we do not want to track using Git. The <a href="https://github.com/RohanAlexander/starter_folder">example folder</a> contains a “.gitignore” file. And it can be helpful to run <code>git_vaccinate()</code> from <code>usethis</code>, which will add a variety of files to a global “.gitignore” file in case you forget to do it on a project basis. Mac users will find it useful that this will cause “.DS_Store” files to be ignored.</p>
</section>
<section id="section-47" class="level2">
<h2 class="anchored" data-anchor-id="section-47"></h2>
<p>We used the Git pane in RStudio which removed the need to use the Terminal, but it did not remove the need to go to GitHub and set up a new project. Having set up Git and GitHub, we can further improve this aspect of our workflow with <code>usethis</code>.</p>
<p>First check that Git is set up with <code>git_sitrep()</code> from <code>usethis</code>. This should print information about the username and email. We can use <code>use_git_config()</code> to update these details if needed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">use_git_config</span>(</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">user.name =</span> <span class="st">"Rohan Alexander"</span>,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">user.email =</span> <span class="st">"rohan.alexander@utoronto.ca"</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-48" class="level2">
<h2 class="anchored" data-anchor-id="section-48"></h2>
<p>Rather than starting a new project in GitHub, and then adding it locally, we can now use <code>use_git()</code> to initiate it and commit the files. Having committed, we can use <code>use_github()</code> to push to GitHub, which will create the folder on GitHub as well.</p>
<p>It is normal to be intimidated by Git and GitHub. Many data scientists only know a little about how to use it, and that is okay. Try to push regularly so that you have a recent snapshot in case you need it.</p>
</section>
</section>
<section id="using-r-in-practice" class="level1">
<h1>Using R in practice</h1>
<section id="sec-dealingwitherrors" class="level2">
<h2 class="anchored" data-anchor-id="sec-dealingwitherrors">Dealing with errors</h2>
<blockquote class="blockquote">
<p>When you are programming, eventually your code will break, when I say eventually, I mean like probably 10 or 20 times a day.</p>
<p><span class="citation" data-cites="sharlatalks">@sharlatalks</span></p>
</blockquote>
</section>
<section id="section-49" class="level2">
<h2 class="anchored" data-anchor-id="section-49"></h2>
<p>Everyone who uses R, or any programming language for that matter, has trouble find them at some point. This is normal. Programming is hard. At some point code will not run or will throw an error. This happens to everyone. It is common to get frustrated, but to move forward we develop strategies to work through the issues:</p>
<ol type="1">
<li>If you are getting an error message, then sometimes it will be useful. Try to read it carefully to see if there is anything of use in it.</li>
<li>Try to search for the error message. It can be useful to include “tidyverse” or “in R” in the search to help make the results more appropriate. Sometimes Stack Overflow results can be useful.</li>
<li>Look at the help file for the function by putting “?” before the function, for instance, <code>?pivot_wider()</code>. A common issue is to use a slightly incorrect argument name or format, such as accidentally including a string instead of an object name.</li>
<li>Look at where the error is happening and remove or comment out code until the error is resolved, and then slowly add code back again.</li>
<li>Check the class of the object with <code>class()</code>, for instance, <code>class(data_set$data_column)</code>. Ensure that it is what is expected.</li>
<li>Restart R: “Session” <span class="math inline">\(\rightarrow\)</span> “Restart R and Clear Output”. Then load everything again.</li>
<li>Restart your computer.</li>
<li>Search for what you are trying to do, rather than the error, being sure to include “tidyverse” or “in R” in the search to help make the results more appropriate. For instance, “save PDF of graph in R using ggplot”. Sometimes there are relevant blog posts or Stack Overflow answers that will help.</li>
<li>Make a small, self-contained, reproducible example “reprex” to see if the issue can be isolated and to enable others to help.</li>
<li>If you are working in a Quarto doc then include label in the chunk options to make it easier to find where the mistake may be happening.</li>
</ol>
</section>
<section id="section-50" class="level2">
<h2 class="anchored" data-anchor-id="section-50"></h2>
<p>More generally, while this is not always possible, it is almost always helpful to take a break and come back the next day.</p>
</section>
<section id="section-51" class="level2">
<h2 class="anchored" data-anchor-id="section-51"></h2>
<section id="sec-omgpleasemakeareprexplease" class="level3">
<h3 class="anchored" data-anchor-id="sec-omgpleasemakeareprexplease">Reproducible examples</h3>
<p>Asking for help is a skill like any other. We get better at it with practice. It is important to try not to say “this doesn’t work”, “I tried everything”, “your code does not work”, or “here is the error message, what do I do?”. In general, it is not possible to help based on these comments, because there are too many possible issues. You need to make it easy for others to help you. This involves a few steps.</p>
<ol type="1">
<li>Provide a small, self-contained example of your data, and code, and detail what is going wrong.</li>
<li>Document what you have tried so far, including which Stack Overflow and Posit Forum posts you looked at, and why they are not what you are after.</li>
<li>Be clear about the outcome that you would like.</li>
</ol>
</section>
</section>
<section id="section-52" class="level2">
<h2 class="anchored" data-anchor-id="section-52"></h2>
<p>Begin by creating a minimal REPRoducible EXample—a “reprex”. This is code that contains what is needed to reproduce the error, but only what is needed. This means that the code is likely a smaller, simpler version that nonetheless reproduces the error.</p>
<p>Sometimes this process enables one to solve the problem. If it does not, then it gives someone else a fighting chance of being able to help. There is almost no chance that you have got a problem that someone has not addressed before. It is more likely that the main difficulty is trying to communicate what you want to do and what is happening, in a way that allows others to recognize both. Developing tenacity is important.</p>
<p>To develop reproducible examples, <code>reprex</code> is especially useful. After installing it we:</p>
<ol type="1">
<li>Load the <code>reprex</code> package: <code>library(reprex)</code>.</li>
<li>Highlight and copy the code that is giving issues.</li>
<li>Run <code>reprex()</code> in the console.</li>
</ol>
<p>If the code is self-contained, then it will preview in the viewer. If it is not, then it will error, and you should rewrite the code so that it is self-contained.</p>
</section>
<section id="section-53" class="level2">
<h2 class="anchored" data-anchor-id="section-53"></h2>
<p>If you need data to reproduce the error, then you should use data that is built into R. There are a large number of datasets that are built into R and can be seen using <code>library(help = "datasets")</code>. But if possible, you should use a common option such as <code>mtcars</code> or <code>faithful</code>. Combining a reprex with a GitHub Gist that was introduced in <strong>?@sec-fire-hose</strong> increases the chances that someone is able to help you.</p>
</section>
<section id="section-54" class="level2">
<h2 class="anchored" data-anchor-id="section-54"></h2>
<section id="mentality" class="level3">
<h3 class="anchored" data-anchor-id="mentality">Mentality</h3>
<blockquote class="blockquote">
<p>(Y)ou are a real, valid, <em>competent</em> user and programmer no matter what IDE you develop in or what tools you use to make your work work for you</p>
<p>(L)et’s break down the gates, there’s enough room for everyone</p>
<p>Sharla Gelfand, 10 March 2020.</p>
</blockquote>
<p>If you write code, then you are a programmer, regardless of how you do it, what you are using it for, or who you are. But there are a few traits that one tends to notice great programmers have in common.</p>
</section>
</section>
<section id="section-55" class="level2">
<h2 class="anchored" data-anchor-id="section-55"></h2>
<ul>
<li><strong>Focused:</strong> Often having an aim to “learn R” or similar tends to be problematic, because there is no real end point to that. It tends to be more efficient to have smaller, more specific goals, such as “make a histogram about the 2022 Australian Election with <code>ggplot2</code>”. This is something that can be focused on and achieved in a few hours. The issue with goals that are more nebulous, such as “I want to learn R”, is that it is easier to get lost on tangents and more difficult to get help. This can be demoralizing and lead to people quitting too early.</li>
<li><strong>Curious:</strong> It is almost always useful to “have a go”; that is, if you are not sure, then just try it. In general, the worst that happens is that you waste your time. You can rarely break something irreparably. For instance, if you want to know what happens if you pass a vector instead of a dataframe to <code>ggplot()</code> then try it.</li>
<li><strong>Pragmatic:</strong> At the same time, it can be useful to stick within reasonable bounds, and make one small change each time. For instance, say you want to run some regressions, and are curious about the possibility of using <code>rstanarm</code> instead of <code>lm()</code>. A pragmatic way to proceed is to use one aspect from <code>rstanarm</code> initially and then make another change next time.</li>
<li><strong>Tenacious:</strong> Again, this is a balancing act. Unexpected problems and issues arise with every project. On the one hand, persevering despite these is a good tendency. But on the other hand, sometimes one does need to be prepared to give up on something if it does not seem like a break through is possible. Mentors can be useful as they tend to be a better judge of what is reasonable.</li>
<li><strong>Planned:</strong> It is almost always useful to excessively plan what you are going to do. For instance, you may want to make a histogram of some data. You should plan the steps that are needed and even sketch out how each step might be implemented. For instance, the first step is to get the data. What packages might be useful? Where might the data be? What is the back-up plan if the data do not exist there?</li>
<li><strong>Done is better than perfect:</strong> We all have various perfectionist tendencies, but it can be useful to initially try to turn them off to a certain extent. Initially just worry about writing code that works. You can always come back and improve aspects of it. But it is important to actually ship. Ugly code that gets the job done is better than beautiful code that is never finished.</li>
</ul>
</section>
<section id="code-comments-and-style" class="level2">
<h2 class="anchored" data-anchor-id="code-comments-and-style">Code comments and style</h2>
<p>Code must be commented. Comments should focus on why certain code was written and to a lesser extent, why a common alternative was not selected. Indeed, it can be a good idea to write the comments before you write the code, explaining what you want to do and why, and then returning to write the code <span class="citation" data-cites="refactoringbook">[@refactoringbook, p. 59]</span>.</p>
<p>There is no one way to write code, especially in R. However, there are some general guidelines that will make it easier for you even if you are just working on your own. Most projects will evolve over time, and one purpose of code comments is to enable future-you to retrace what was done and why certain decisions were made <span class="citation" data-cites="bowers2016improve">[@bowers2016improve]</span>.</p>
</section>
<section id="section-56" class="level2">
<h2 class="anchored" data-anchor-id="section-56"></h2>
<p>Comments in R scripts can be added by including the # symbol. (The behavior of # is different for lines inside an R chunk in a Quarto document where it acts as a comment, compared with lines outside an R chunk where it sets heading levels.) We do not have to put a comment at the start of the line, it can be midway through. In general, you do not need to comment what every aspect of your code is doing but you should comment parts that are not obvious. For instance, if we read in some value then we may like to comment where it is coming from.</p>
<p>You should try to comment why you are doing something <span class="citation" data-cites="tidyversestyleguide">[@tidyversestyleguide]</span>. What are you trying to achieve? You must comment to explain weird things. Like if you are removing some specific row, say row 27, then why are you removing that row? It may seem obvious in the moment, but future-you will not remember.</p>
</section>
<section id="section-57" class="level2">
<h2 class="anchored" data-anchor-id="section-57"></h2>
<p>You should break your code into sections. For instance, setting up the workspace, reading in datasets, manipulating and cleaning the datasets, analyzing the datasets, and finally producing tables and figures. Each of these should be separated with comments explaining what is going on, and sometimes into separate files, depending on the length.</p>
</section>
<section id="section-58" class="level2">
<h2 class="anchored" data-anchor-id="section-58"></h2>
<p>Additionally, at the top of each file it is important to note basic information, such as the purpose of the file, and prerequisites or dependencies, the date, the author and contact information, and finally any red flags or todos.</p>
<p>Your R scripts should have a preamble and a clear demarcation of sections.</p>
<pre><code>#### Preamble ####
# Purpose: Brief sentence about what this script does
# Author: Your name
# Date: The date it was written
# Contact: Add your email
# License: Think about how your code may be used
# Pre-requisites: 
# - Maybe you need some data or some other script to have been run?


#### Workspace setup ####
# do not keep install.packages lines; comment out if need be
# Load packages
library(tidyverse)

# Read in the unedited data. 
raw_data &lt;- read_csv("inputs/data/unedited_data.csv")


#### Next section ####
...
</code></pre>
</section>
<section id="section-59" class="level2">
<h2 class="anchored" data-anchor-id="section-59"></h2>
<p>Finally, try not to rely on a user commenting and uncommenting code, or any other manual step, such as directory specification, for code to work. This will preclude the use of automated code checking and testing.</p>
<p>This all takes time. As a rough rule of thumb, you should expect to spend at least as much time commenting and improving your code as you spent writing it. Some examples of nicely commented code include <span class="citation" data-cites="AhadyDolatsara2021">@AhadyDolatsara2021</span> and <span class="citation" data-cites="burton2021reconsidering">@burton2021reconsidering</span>.</p>
</section>
<section id="tests" class="level2">
<h2 class="anchored" data-anchor-id="tests">Tests</h2>
<p>Tests should be written throughout the code, and you need to write them as we go, not all at the end. This will slow you down. But it will help you to think, and to fix mistakes, which will make your code better and lead to better overall productivity. Code without tests should be viewed with suspicion. There is room for improvement when it comes to testing practices in R packages <span class="citation" data-cites="Vidoni2021">[@Vidoni2021]</span>, let alone R code more generally.</p>
<p>The need for other people, and ideally, automated processes, to run tests on code is one reason that we emphasize reproducibility. That is also why we emphasize smaller aspects such as not hardcoding file-paths, using projects, and not having spaces in file names.</p>
</section>
<section id="section-60" class="level2">
<h2 class="anchored" data-anchor-id="section-60"></h2>
<p>It is difficult to define a complete and general suite of tests, but broadly we want to test:</p>
<ol type="1">
<li>boundary conditions,</li>
<li>classes,</li>
<li>missing data,</li>
<li>the number of observations and variables,</li>
<li>duplicates, and</li>
<li>regression results.</li>
</ol>
</section>
<section id="section-61" class="level2">
<h2 class="anchored" data-anchor-id="section-61"></h2>
<p>We do all this initially on our simulated data and then move to the real data. The mirrors the evolution of testing during the Apollo Program. Initially testing occured based on expectations of requirements, and these tests were later updated to take into account actual launch measurements <span class="citation" data-cites="testingforsuccess">[@testingforsuccess, p. 21]</span>. It is possible to write an infinite number of tests but a smaller number of high-quality tests is better than many thoughtless tests.</p>
</section>
<section id="section-62" class="level2">
<h2 class="anchored" data-anchor-id="section-62"></h2>
<p>One type of test is an “assertion”. Assertions are written throughout the code to check whether something is true and stop the code from running if not <span class="citation" data-cites="researchsoftware">[@researchsoftware, p. 272]</span>. For instance, you might assert that a variable should be numeric. If it was tested against this assertion and found to be a character, then the test would fail and the script would stop running. Assertion tests in data science will typically be used in data cleaning and preparation scripts. We have more to say about these in <strong>?@sec-clean-and-prepare</strong>. Unit tests check some complete aspect of code <span class="citation" data-cites="researchsoftware">[@researchsoftware, p. 274]</span>. We will consider them more in <strong>?@sec-its-just-a-linear-model</strong> when we consider modeling.</p>
</section>
<section id="efficiency" class="level2">
<h2 class="anchored" data-anchor-id="efficiency">Efficiency</h2>
<p>Generally in this book we are, and will continue to be, concerned with just getting something done. Not necessarily getting it done in the best or most efficient way, because to a large extent, being worried about that is a waste of time. For the most part one is better off just pushing things into the cloud, letting them run for a reasonable time, and using that time to worry about other aspects of the pipeline. But that eventually becomes unfeasible. At a certain point, and this differs depending on context, efficiency becomes important. Eventually ugly or slow code, and dogmatic insistence on a particular way of doing things, have an effect. And it is at that point that one needs to be open to new approaches to ensure efficiency. There is rarely a most common area for obvious performance gains. Instead, it is important to develop the ability to measure, evaluate, and think.</p>
</section>
<section id="section-63" class="level2">
<h2 class="anchored" data-anchor-id="section-63"></h2>
<p>One of the best ways to improve the efficiency of our code is preparing it in such a way that we can bring in a second pair of eyes. To make the most of their time, it is important that our code easy to read. So we start with “code linting” and “styling”. This does not speed up our code, per se, but instead makes it more efficient when another person comes to it, or we revisit it. This enables formal code review and refactoring, which is where we rewrite code to make it better, while not changing what it does (it does the same thing, but in a different way). We then turn to measurement of run time, and introduce parallel processing, where we allow our computer to run code for multiple processes at the same time</p>
</section>
<section id="sharing-a-code-environment" class="level2">
<h2 class="anchored" data-anchor-id="sharing-a-code-environment">Sharing a code environment</h2>
<p>We have discussed at length the need to share code, and we have put forward an approach to this using GitHub. And in <strong>?@sec-store-and-share</strong>, we will discuss sharing data. But, there is another requirement to enable other people to run our code. In <strong>?@sec-fire-hose</strong> we discussed how R itself, as well as R packages update from time to time, as new functionality is developed, errors fixed, and other general improvements made. <strong>?@sec-r-essentials</strong> describes how one advantage of the <code>tidyverse</code> is that it can update faster than base R, because it is more specific. But this could mean that even if we were to share all the code and data that we use, it is possible that the software versions that have become available would cause errors.</p>
</section>
<section id="section-64" class="level2">
<h2 class="anchored" data-anchor-id="section-64"></h2>
<p>The solution to this is to detail the environment that was used. There are a large number of ways to do this, and they can add complexity. We just focus on documenting the version of R and R packages that were used, and making it easier for others to install that exact version. Essentially we are just isolating the set-up that we used because that will help with reproducibility <span class="citation" data-cites="perkel2023">[@perkel2023]</span>. In <code>R</code> we can use <code>renv</code> to do this.</p>
<p>Once <code>renv</code> is installed and loaded, we use <code>init()</code> to get the infrastructure set-up that we will need. We are going to create a file that will record the packages and versions used. We then use <code>snapshot()</code> to actually document what we are using. This creates a “lockfile” that records the information.</p>
</section>
<section id="section-65" class="level2">
<h2 class="anchored" data-anchor-id="section-65"></h2>
<p>If we want to see which packages we are using in the R Project, then we can use <code>dependencies()</code>. Doing this for the <a href="https://github.com/RohanAlexander/starter_folder">example folder</a> indicates that the following packages are used: <code>rmarkdown</code>, <code>bookdown</code>, <code>knitr</code>, <code>rmarkdown</code>, <code>bookdown</code>, <code>knitr</code>, <code>palmerpenguins</code>, <code>tidyverse</code>, <code>renv</code>, <code>haven</code>, <code>readr</code>, and <code>tidyverse</code>.</p>
</section>
<section id="section-66" class="level2">
<h2 class="anchored" data-anchor-id="section-66"></h2>
<p>We could open the lockfile file—“renv.lock”—to see the exact versions if we wanted. The lockfile also documents all the other packages that were installed and where they were downloaded from. Someone coming to this project from outside could then use <code>restore()</code> which would install the exact version of the packages that we used.</p>
</section>
<section id="code-linting-and-styling" class="level2">
<h2 class="anchored" data-anchor-id="code-linting-and-styling">Code linting and styling</h2>
<p>Being fast is valuable but it is mostly about being able to iterate fast, not necessarily having code that runs fast. <span class="citation" data-cites="oldlanguages">@oldlanguages [p. 26]</span> describes how even in 1954 a programmer cost at least as much as a computer, and these days additional computational power is usually much cheaper than a programmer. Performant code is important, but it is also important to use other people’s time efficiently. Code is rarely only written once. Instead we typically have to come back to it, even if to just fix mistakes, and this means that code must be able to be read by humans <span class="citation" data-cites="beautifulcode">[@beautifulcode, p. 478]</span>. If this is not done then there will be an efficiency cost.</p>
<p>Linting and styling is the process of checking code, mostly for stylistic issues, and re-arranging code to make it easier to read. (There is another aspect of linting, which is dealing with programming errors, such as forgetting a closing bracket, but here we focus on stylistic issues.) Often the best efficiency gain comes from making it easier for others to read our code, even if this is just ourselves returning to the code after a break. Jane Street, a US proprietary trading firm, places a very strong focus on ensuring their code is readable, as a core part of risk mitigation <span class="citation" data-cites="minsky2011ocaml">[@minsky2011ocaml]</span>. While we may not all have billions of dollars under the potentially mercurial management of code, we all would likely prefer that our code does not produce errors.</p>
</section>
<section id="section-67" class="level2">
<h2 class="anchored" data-anchor-id="section-67"></h2>
<p>We use <code>lint()</code> from <code>lintr</code> to lint our code. For instance, consider the following R code (saved as “linting_example.R”).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>SIMULATED_DATA <span class="ot">&lt;-</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">division =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">150</span>, <span class="dv">151</span>),</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">party =</span> <span class="fu">sample</span>(</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">x =</span> <span class="fu">c</span>(<span class="st">"Liberal"</span>),</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">151</span>,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">replace =</span> T</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-68" class="level2">
<h2 class="anchored" data-anchor-id="section-68"></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lint</span>(<span class="at">filename =</span> <span class="st">"linting_example.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-69" class="level2">
<h2 class="anchored" data-anchor-id="section-69"></h2>
<p>The result is that the file “linting_example.R” is opened and the issues that <code>lint()</code> found are printed in “Markers” (<a href="#fig-linter" class="quarto-xref">Figure&nbsp;6</a>). It is then up to you to deal with the issues.</p>
<div id="fig-linter" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-linter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/linter.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-linter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Linting results from example R code
</figcaption>
</figure>
</div>
</section>
<section id="section-70" class="level2">
<h2 class="anchored" data-anchor-id="section-70"></h2>
<p>Making the recommended changes results in code that is more readable, and consistent with best practice, as defined by <span class="citation" data-cites="tidyversestyleguide">@tidyversestyleguide</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>simulated_data <span class="ot">&lt;-</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">division =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">150</span>, <span class="dv">151</span>),</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">party =</span> <span class="fu">sample</span>(</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">x =</span> <span class="fu">c</span>(<span class="st">"Liberal"</span>),</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">151</span>,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">replace =</span> <span class="cn">TRUE</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-71" class="level2">
<h2 class="anchored" data-anchor-id="section-71"></h2>
<p>At first it may seem that some aspects that the linter is identifying, like trailing whitespace and only using double quotes are small and inconsequential. But they distract from being able to fix bigger issues. Further, if we are not able to get small things right, then how could anyone trust that we could get the big things right? Therefore, it is important to have dealt with all the small aspects that a linter identifies.</p>
</section>
<section id="section-72" class="level2">
<h2 class="anchored" data-anchor-id="section-72"></h2>
<p>In addition to <code>lintr</code> we also use <code>styler</code>. This will automatically adjust style issues, in contrast to the linter, which gave a list of issues to look at. To run this we use <code>style_file()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">style_file</span>(<span class="at">path =</span> <span class="st">"linting_example.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This will automatically make changes, such as spacing and indentation. As such this should be done regularly, rather than only once at the end of a project, so as to be able to review the changes and make sure no errors have been introduced.</p>
</section>
<section id="code-review" class="level2">
<h2 class="anchored" data-anchor-id="code-review">Code review</h2>
<p>Having dealt with all of these aspects of style, we can turn to code review. This is the process of having another person go through and critique the code. Many professional writers have editors, and code review is the closest that we come to that in data science. Code review is a critical part of writing code, and <span class="citation" data-cites="researchsoftware">@researchsoftware [p. 465]</span> describe it as “the most effective way to find bugs”. It is especially helpful, although quite daunting, when learning to code because getting feedback is a great way to improve.</p>
</section>
<section id="section-73" class="level2">
<h2 class="anchored" data-anchor-id="section-73"></h2>
<p>Go out of your way to be polite and collegial when reviewing another person’s code. Small aspects to do with style, things like spacing and separation, should have been taken care of by a linter and styler, but if not, then make a general recommendation about that. Most of your time as a code reviewer in data science should be spent on aspects such as:</p>
<ol type="1">
<li>Is there an informative README and how could it be improved?</li>
<li>Are the file names and variable names consistent, informative, and meaningful?</li>
<li>Do the comments allow you to understand why something is being done?</li>
<li>Are the tests both appropriate and sufficient? Are there edge cases or corner solutions that are not considered? Similarly, are there unnecessary tests that could be removed?</li>
<li>Are there magic numbers that could be changed to variables and explained?</li>
<li>Is there duplicated code that could be changed?</li>
<li>Are there any outstanding warnings that should be addressed?</li>
<li>Are there any especially large functions or pipes that could be separated into smaller ones?</li>
<li>Is the structure of the project appropriate?</li>
<li>Can we change any of the code to data <span class="citation" data-cites="researchsoftware">[@researchsoftware, p. 462]</span>?</li>
</ol>
</section>
<section id="section-74" class="level2">
<h2 class="anchored" data-anchor-id="section-74"></h2>
<p>For instance, consider some code that looked for the names of prime ministers and presidents. When we first wrote this code we likely added the relevant names directly into the code. But as part of code review, we might instead recommend that this be changed. We might recommend creating a small dataset of relevant names, and then re-writing the code to have it look up that dataset.</p>
<p>Code review ensures that the code can be understood by at least one other person. This is a critical part of building knowledge about the world. At Google, code review is not primarily about finding defects, although that may happen, but is instead about ensuring readability and maintainability as well as education <span class="citation" data-cites="codereview">[@codereview]</span>. This is also the case at Jane Street where they use code review to catch bugs, share institutional knowledge, assist with training, and oblige staff to write code that can be read <span class="citation" data-cites="ocamlyaronpodcast">[@ocamlyaronpodcast]</span>.</p>
</section>
<section id="section-75" class="level2">
<h2 class="anchored" data-anchor-id="section-75"></h2>
<p>Finally, code review does not have to, and should not, be an onerous days-consuming process of reading all the code. The best code review is a quick review of just one file, focused on suggesting changes to just a handful of lines. Indeed, it may be better to have a review done by a small team of people rather than one individual. Do not review too much code at any one time. At most a few hundred lines, which should take around an hour, because any more than that has been found to be associated with reduced efficacy <span class="citation" data-cites="cohen2006best">[@cohen2006best, p. 79]</span>.</p>
</section>
<section id="code-refactoring" class="level2">
<h2 class="anchored" data-anchor-id="code-refactoring">Code refactoring</h2>
<p>To refactor code means to rewrite it so that the new code achieves the same outcome as the old code, but the new code does it better. For instance, <span class="citation" data-cites="refactornature">@refactornature</span> discuss how the code underpinning an important UK Covid model was initially written by epidemiologists, and months later clarified and cleaned up by a team from the Royal Society, Microsoft, and GitHub. This was valuable because it provided more confidence in the model, even though both versions produced the same outputs, given the same inputs.</p>
</section>
<section id="section-76" class="level2">
<h2 class="anchored" data-anchor-id="section-76"></h2>
<p>We typically refer to code refactoring in relation to code that someone else wrote. (Although it may be that we actually wrote the code, and it was just that it was some time ago.) When we start to refactor code, we want to make sure that the rewritten code achieves the same outcomes as the original code. This means that we need a suite of appropriate tests written that we can depend on. If these do not exist, then we may need to create them.</p>
<p>We rewrite code to make it easier for others to understand, which in turn allows more confidence in our conclusions. But before we can do that, we need to understand what the existing code is doing. One way to get started is to go through the code and add extensive comments. These comments are different to normal comments. They are our active process of trying to understand what is each code chunk trying to do and how could this be improved.</p>
</section>
<section id="section-77" class="level2">
<h2 class="anchored" data-anchor-id="section-77"></h2>
<p>Refactoring code is an opportunity to ensure that it satisfies best practice. <span class="citation" data-cites="Trisovic2022">@Trisovic2022</span> details some core recommendations based on examining 9,000 R scripts including:</p>
<ol type="1">
<li>Remove <code>setwd()</code> and any absolute paths, and ensure that only relative paths, in relation to the “.Rproj” file, are used.</li>
<li>Ensure there is a clear order of execution. We have recommended using numbers in filenames to achieve this initially, but eventually more sophisticated approaches, such as <code>targets</code> <span class="citation" data-cites="targets">[@targets]</span>, could be used instead.</li>
<li>Ensure that code can run on a different computer.</li>
</ol>
</section>
<section id="section-78" class="level2">
<h2 class="anchored" data-anchor-id="section-78"></h2>
<p>For instance, consider the following code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"/Users/rohanalexander/Documents/telling_stories"</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"cars.csv"</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>mtcars <span class="ot">&lt;-</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    mtcars <span class="sc">|&gt;</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">K_P_L =</span> mpg <span class="sc">/</span> <span class="fl">2.352</span>)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(datasauRus)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>datasaurus_dozen</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-79" class="level2">
<h2 class="anchored" data-anchor-id="section-79"></h2>
<p>We could change that, starting by creating an R Project which enables us to remove <code>setwd()</code>, grouping all the <code>library()</code> calls at the top, using “&lt;-” instead of “=”, and being consistent with variable names:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(datasauRus)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>cars_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"cars.csv"</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>mpg_to_kpl_conversion_factor <span class="ot">&lt;-</span> <span class="fl">2.352</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>mtcars <span class="ot">&lt;-</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    mtcars <span class="sc">|&gt;</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">kpl =</span> mpg <span class="sc">/</span> mpg_to_kpl_conversion_factor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="concluding-remarks" class="level2">
<h2 class="anchored" data-anchor-id="concluding-remarks">Concluding remarks</h2>
<p>In this chapter we have considered much and it is normal to be overwhelmed. Come back to the Quarto section as needed. Many people are confused by Git and GitHub and just know enough to get by. And while there was a lot of material in efficiency, the most important aspect of performant code is making it easier for another person to read it, even if that person is just yourself returning after a break.</p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>


</section>
</section>

<script async="" defer="" src="https://scripts.simpleanalyticscdn.com/latest.js"></script></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/www\.johnmclevey\.com\/quantitative-research-methods\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Built with <a href="https://quarto.org">Quarto</a> and <a href="https://github.com">GitHub</a> by <a href="https://www.johnmclevey.com">John McLevey</a></p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>