<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>lecture-10-content – 🔥 Quantitative Research Methods</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">🔥 Quantitative Research Methods</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../syllabus/syllabus.html" aria-current="page"> <i class="bi bi-info-circle-fill" role="img">
</i> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../lectures/list-lectures.html"> <i class="bi bi-journal-code" role="img">
</i> 
<span class="menu-text">Class &amp; Lab Notes</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-slides" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-file-slides-fill" role="img">
</i> 
 <span class="menu-text">Slides</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-slides">    
        <li>
    <a class="dropdown-item" href="../lectures/lecture-01-slides.html">
 <span class="dropdown-text">Class 01 – <strong>Introduction</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-02-slides.html">
 <span class="dropdown-text">Class 02 – <strong>Telling Stories with Data</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-03-slides.html">
 <span class="dropdown-text">Class 03 – <strong>Workflow – Plan, Simulate, Acquire, Explore, Share</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-04-slides.html">
 <span class="dropdown-text">Class 04 – <strong>Good and Bad Ways to Look at Data</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-05-slides.html">
 <span class="dropdown-text">Class 05 – <strong>Reproducibility + Getting Started with R and RStudio</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-06-slides.html">
 <span class="dropdown-text">Class 06 – <strong>Reproducibility + Getting Started with R and RStudio</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-07-slides.html">
 <span class="dropdown-text">Class 07 – <strong>Writing and Developing Research Questions</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-08-slides.html">
 <span class="dropdown-text">Class 08 – <strong>The Grammar of Graphics, Plotting in the Tidyverse</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-09-slides.html">
 <span class="dropdown-text">Class 09 – <strong>Showing the Right Numbers</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-10-slides.html">
 <span class="dropdown-text">Class 10 – <strong>Piping, Summarizing, and Transforming</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-11-slides.html">
 <span class="dropdown-text">Class 11 – <strong>Measurement</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-12-slides.html">
 <span class="dropdown-text">Class 12 – <strong>Sampling</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-13-slides.html">
 <span class="dropdown-text">Class 13 – <strong>Experiments</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-14-slides.html">
 <span class="dropdown-text">Class 14 – <strong>Surveys</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-15-slides.html">
 <span class="dropdown-text">Class 15 – <strong>Data Cleaning and Preparation</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-16-slides.html">
 <span class="dropdown-text">Class 16 – <strong>Exploratory Data Analysis (EDA)</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-17-slides.html">
 <span class="dropdown-text">Class 17 – <strong>Linear Models</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-18-slides.html">
 <span class="dropdown-text">Class 18 – <strong>Linear Models + Model-based Graphics</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-19-slides.html">
 <span class="dropdown-text">Class 19 – <strong>Generalized Linear Models (Binary Outcomes)</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-20-slides.html">
 <span class="dropdown-text">Class 20 – <strong>Generalized Linear Models (Count Outcomes)</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-21-slides.html">
 <span class="dropdown-text">Class 21 – <strong>Mutilevel Models</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-22-slides.html">
 <span class="dropdown-text">Class 22 – <strong>Mutilevel Models</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-23-slides.html">
 <span class="dropdown-text">Class 23 – <strong>Multilevel Regression with Poststratification (MRP)</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-24-slides.html">
 <span class="dropdown-text">Class 24 – <strong>Project Work</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/lecture-25-slides.html">
 <span class="dropdown-text">Class 25 – <strong>Project Work</strong></span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-telling-stories-with-data" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-fire" role="img">
</i> 
 <span class="menu-text">Telling Stories with Data</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-telling-stories-with-data">    
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com">
 <span class="dropdown-text"><strong>Preface</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/01-introduction.html">
 <span class="dropdown-text">Chapter 01 – <strong>Telling stories with data</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/02-drinking_from_a_fire_hose.html">
 <span class="dropdown-text">Chapter 02 – <strong>Drinking from a fire hose</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/03-workflow.html">
 <span class="dropdown-text">Chapter 03 – <strong>Reproducible workflows</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/04-writing_research.html">
 <span class="dropdown-text">Chapter 04 – <strong>Writing research</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/05-static_communication.html">
 <span class="dropdown-text">Chapter 05 – <strong>Graphs, tables, and maps</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/06-farm.html">
 <span class="dropdown-text">Chapter 06 – <strong>Measurement, censuses, and sampling</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/07-gather.html">
 <span class="dropdown-text">Chapter 07 – <strong>APIs, scraping, and parsing</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/08-hunt.html">
 <span class="dropdown-text">Chapter 08 – <strong>Experiments and surveys</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/09-clean_and_prepare.html">
 <span class="dropdown-text">Chapter 09 – <strong>Clean and prepare</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/10-store_and_share.html">
 <span class="dropdown-text">Chapter 10 – <strong>Store and share</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/11-eda.html">
 <span class="dropdown-text">Chapter 11 – <strong>Exploratory data analysis</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/12-ijalm.html">
 <span class="dropdown-text">Chapter 12 – <strong>Linear models</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/13-ijaglm.html">
 <span class="dropdown-text">Chapter 13 – <strong>Generalized Linear Models</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/13-prediction.html">
 <span class="dropdown-text">Chapter 14 – <strong>Prediction</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/14-causality_from_obs.html">
 <span class="dropdown-text">Chapter 15 – <strong>Causality from observational data</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/15-mrp.html">
 <span class="dropdown-text">Chapter 16 – <strong>Multilevel regression with post-stratification</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/16-text.html">
 <span class="dropdown-text">Chapter 17 – <strong>Text as data</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/17-concluding.html">
 <span class="dropdown-text">Chapter 18 – <strong>Concluding remarks</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/20-r_essentials.html">
 <span class="dropdown-text">Appendix – <strong>R essentials</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/21-datasets.html">
 <span class="dropdown-text">Appendix – <strong>Datasets</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/25-datasheet.html">
 <span class="dropdown-text">Appendix – <strong>Datasheets</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://tellingstorieswithdata.com/98-cocktails.html">
 <span class="dropdown-text">Appendix – <strong>Cocktails 🥃🍸</strong></span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-data-visualization" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-activity" role="img">
</i> 
 <span class="menu-text">Data Visualization</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-data-visualization">    
        <li>
    <a class="dropdown-item" href="https://socviz.co/index.html">
 <span class="dropdown-text"><strong>Preface</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://socviz.co/lookatdata.html#lookatdata">
 <span class="dropdown-text">Chapter 1 – <strong>Look at Data</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://socviz.co/gettingstarted.html#gettingstarted">
 <span class="dropdown-text">Chapter 2 – <strong>Get Started</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://socviz.co/makeplot.html#makeplot">
 <span class="dropdown-text">Chapter 3 – <strong>Make a Plot</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://socviz.co/groupfacettx.html#groupfacettx">
 <span class="dropdown-text">Chapter 4 – <strong>Show the Right Numbers</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://socviz.co/workgeoms.html#workgeoms">
 <span class="dropdown-text">Chapter 5 – <strong>Graph Tables, Add Labels, Make Notes</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://socviz.co/modeling.html#modeling">
 <span class="dropdown-text">Chapter 6 – <strong>Work with Models</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://socviz.co/maps.html#maps">
 <span class="dropdown-text">Chapter 7 – <strong>Draw Maps</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://socviz.co/refineplots.html#refineplots">
 <span class="dropdown-text">Chapter 8 – <strong>Refine Your Plots</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://socviz.co/appendix.html#appendix">
 <span class="dropdown-text"><strong>Appendix</strong></span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-statistical-rethinking" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-flower1" role="img">
</i> 
 <span class="menu-text">Statistical Rethinking</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-statistical-rethinking">    
        <li>
    <a class="dropdown-item" href="https://youtu.be/FdnMWdICdRs?si=2jrjHmBZPwpNKIjd"><i class="bi bi-youtube" role="img">
</i> 
 <span class="dropdown-text">Lecture 01 – <strong>The Golem of Prague</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://youtu.be/R1vcdhPBlXA?si=E0Z1TTnoqK314JC8"><i class="bi bi-youtube" role="img">
</i> 
 <span class="dropdown-text">Lecture 02 – <strong>The Garden of Forking Data</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://youtu.be/tNOu-SEacNU?si=cQ6KCXPL3NJWhq-9"><i class="bi bi-youtube" role="img">
</i> 
 <span class="dropdown-text">Lecture 03 – <strong>Geocentric Models</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://youtu.be/F0N4b7K_iYQ?si=x2OfAN1zDQk2JR5P"><i class="bi bi-youtube" role="img">
</i> 
 <span class="dropdown-text">Lecture 04 – <strong>Categories &amp; Curves</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://youtu.be/mBEA7PKDmiY?si=Hj8ZC7e8cYPKWktd"><i class="bi bi-youtube" role="img">
</i> 
 <span class="dropdown-text">Lecture 05 – <strong>Elemental Confounds</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://youtu.be/uanZZLlzKHw?si=-NjSgQ9htg1sKyvQ"><i class="bi bi-youtube" role="img">
</i> 
 <span class="dropdown-text">Lecture 06 – <strong>Good and Bad Controls</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://youtu.be/1VgYIsANQck?si=isqGSfDQtCViFhXl"><i class="bi bi-youtube" role="img">
</i> 
 <span class="dropdown-text">Lecture 07 – <strong>Fitting Over and Under</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://youtu.be/rZk2FqX2XnY?si=u0MtulsVegwO1G5M"><i class="bi bi-youtube" role="img">
</i> 
 <span class="dropdown-text">Lecture 08 – <strong>Markov Chain Monte Carlo</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://youtu.be/Zi6N3GLUJmw?si=Vr4Xjhujh5AD-dKR"><i class="bi bi-youtube" role="img">
</i> 
 <span class="dropdown-text">Lecture 09 – <strong>Modeling Events</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://youtu.be/jokxu18egu0?si=q44lfkL8_Au77yWC"><i class="bi bi-youtube" role="img">
</i> 
 <span class="dropdown-text">Lecture 10 – <strong>Counts &amp; Hidden Confounds</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://youtu.be/VVQaIkom5D0?si=t_0PXlOEFybrlVFo"><i class="bi bi-youtube" role="img">
</i> 
 <span class="dropdown-text">Lecture 11 – <strong>Ordered Categories</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://youtu.be/iwVqiiXYeC4?si=ryU8pArGgqGD1fJn"><i class="bi bi-youtube" role="img">
</i> 
 <span class="dropdown-text">Lecture 12 – <strong>Multilevel Models</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://youtu.be/sgqMkZeslxA?si=y4rDEW29cJ3463eu"><i class="bi bi-youtube" role="img">
</i> 
 <span class="dropdown-text">Lecture 13 – <strong>Multilevel Adventures</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://youtu.be/Es44-Bp1aKo?si=DyarBHvBH6o0H7NH"><i class="bi bi-youtube" role="img">
</i> 
 <span class="dropdown-text">Lecture 14 – <strong>Correlated Features</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://youtu.be/hnYhJzYAQ60?si=IY5yZ5_85tx8m7zp"><i class="bi bi-youtube" role="img">
</i> 
 <span class="dropdown-text">Lecture 15 – <strong>Social Networks</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://youtu.be/Y2ZLt4iOrXU?si=k7UYhsr1QSt58Dxy"><i class="bi bi-youtube" role="img">
</i> 
 <span class="dropdown-text">Lecture 16 – <strong>Gaussian Processes</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://youtu.be/mt9WKbQJrI4?si=0UWQMM8Bs0x9VweU"><i class="bi bi-youtube" role="img">
</i> 
 <span class="dropdown-text">Lecture 17 – <strong>Measurement &amp; Misclassification</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://youtu.be/Oeq6GChHOzc?si=72k6UxKVDZFIbiHL"><i class="bi bi-youtube" role="img">
</i> 
 <span class="dropdown-text">Lecture 18 – <strong>Missing Data</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://youtu.be/zffwg0xDOgE?si=xn5PbeyUMJHh46Js"><i class="bi bi-youtube" role="img">
</i> 
 <span class="dropdown-text">Lecture 19 – <strong>Generalized Linear Madness</strong></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://youtu.be/qwF-st2NGTU?si=yufeuPJQ_pn6_ZJg"><i class="bi bi-youtube" role="img">
</i> 
 <span class="dropdown-text">Lecture 20 – <strong>Horoscopes</strong></span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="https://www.johnmclevey.com"> <i class="bi bi-person-vcard-fill" role="img">
</i> 
<span class="menu-text">John McLevey</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>SYLLABUS</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus/syllabus.html" class="sidebar-item-text sidebar-link"><i class="bi bi-info-circle-fill" role="img">
</i> 
 <span class="menu-text">&nbsp;&nbsp;SOCI 3040</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus/schedule.html" class="sidebar-item-text sidebar-link"><i class="bi bi-calendar-fill" role="img">
</i> 
 <span class="menu-text">&nbsp;&nbsp;Course Schedule</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus/assessment.html" class="sidebar-item-text sidebar-link"><i class="bi bi-check2-square" role="img">
</i> 
 <span class="menu-text">&nbsp;&nbsp;Assessment</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus/computing.html" class="sidebar-item-text sidebar-link"><i class="bi bi-laptop" role="img">
</i> 
 <span class="menu-text">&nbsp;&nbsp;Computing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus/policies.html" class="sidebar-item-text sidebar-link"><i class="bi bi-box-fill" role="img">
</i> 
 <span class="menu-text">&nbsp;&nbsp;Policies</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
 <span class="menu-text"><br></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>ASSIGNMENTS</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../deliverables/assignment-1.html" class="sidebar-item-text sidebar-link"><i class="bi bi-file-post" role="img">
</i> 
 <span class="menu-text">&nbsp;&nbsp;Data Stories 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../deliverables/assignment-2.html" class="sidebar-item-text sidebar-link"><i class="bi bi-file-post" role="img">
</i> 
 <span class="menu-text">&nbsp;&nbsp;Data Stories 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../deliverables/assignment-3.html" class="sidebar-item-text sidebar-link"><i class="bi bi-file-post" role="img">
</i> 
 <span class="menu-text">&nbsp;&nbsp;Data Stories 3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../deliverables/assignment-4.html" class="sidebar-item-text sidebar-link"><i class="bi bi-file-post" role="img">
</i> 
 <span class="menu-text">&nbsp;&nbsp;Data Stories 4</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
 <span class="menu-text"><br></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>QUICK LINKS</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://online.mun.ca/d2l/home/605570" class="sidebar-item-text sidebar-link"><i class="bi bi-link-45deg" role="img">
</i> 
 <span class="menu-text">&nbsp;&nbsp;3040 on Brightspace</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://www.mun.ca/studentwellness/" class="sidebar-item-text sidebar-link"><i class="bi bi-link-45deg" role="img">
</i> 
 <span class="menu-text">&nbsp;&nbsp;Student Wellness</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://www.mun.ca/studentwellness/counselling-services/" class="sidebar-item-text sidebar-link"><i class="bi bi-link-45deg" role="img">
</i> 
 <span class="menu-text">&nbsp;&nbsp;Counselling Centre</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://www.mun.ca/munup/academic-success-centre/" class="sidebar-item-text sidebar-link"><i class="bi bi-link-45deg" role="img">
</i> 
 <span class="menu-text">&nbsp;&nbsp;Academic Success Centre</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://www.mun.ca/munup/academic-success-centre/learning-supports/accessibility-services/" class="sidebar-item-text sidebar-link"><i class="bi bi-link-45deg" role="img">
</i> 
 <span class="menu-text">&nbsp;&nbsp;Accessibility Services</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="-1">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#api-example-openalexr" id="toc-api-example-openalexr" class="nav-link active" data-scroll-target="#api-example-openalexr">API Example: <code>OpenAlexR</code></a>
  <ul>
  <li><a href="#finding-memorials-openalex-institutional-id" id="toc-finding-memorials-openalex-institutional-id" class="nav-link" data-scroll-target="#finding-memorials-openalex-institutional-id">Finding Memorial’s OpenAlex Institutional ID</a></li>
  <li><a href="#query-the-openalex-api" id="toc-query-the-openalex-api" class="nav-link" data-scroll-target="#query-the-openalex-api">Query the OpenAlex API</a></li>
  <li><a href="#store-the-data" id="toc-store-the-data" class="nav-link" data-scroll-target="#store-the-data">Store the Data!</a></li>
  <li><a href="#more-than-names" id="toc-more-than-names" class="nav-link" data-scroll-target="#more-than-names">More than Names</a></li>
  <li><a href="#key-concepts-and-common-words" id="toc-key-concepts-and-common-words" class="nav-link" data-scroll-target="#key-concepts-and-common-words">Key Concepts and Common Words</a></li>
  <li><a href="#visualizing-word-frequencies" id="toc-visualizing-word-frequencies" class="nav-link" data-scroll-target="#visualizing-word-frequencies">Visualizing Word Frequencies</a></li>
  <li><a href="#fields" id="toc-fields" class="nav-link" data-scroll-target="#fields">Fields</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">




<section id="api-example-openalexr" class="level1">
<h1>API Example: <code>OpenAlexR</code></h1>
<blockquote class="blockquote">
<p>Use the “Polite Pool” if you have an API Key!</p>
</blockquote>
<p>Our goal will be to retrieve publications by researchers at Memorial University who have authored more than 10 publications (indexed in OpenAlex) using the OpenAlex API, and to begin working with the data objects returned from the API.</p>
<blockquote class="blockquote">
<p>Note that some of the code in this notebook will take some time to run, especially when downloading data. Be patient, and change the query parameters if you must.</p>
</blockquote>
<p>We’ll load the <code>openalexR</code> and <code>tidyverse</code> packages. Don’t forget to install <code>openalexR</code> in your PostCloud if you haven’t already done so!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openalexR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Thank you for using openalexR!
To acknowledge our work, please cite the package by calling `citation("openalexR")`.
To suppress this message, add `openalexR.message = suppressed` to your .Renviron file.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="finding-memorials-openalex-institutional-id" class="level2">
<h2 class="anchored" data-anchor-id="finding-memorials-openalex-institutional-id">Finding Memorial’s OpenAlex Institutional ID</h2>
<p>To start, we need to find Memorial’s “<strong>Institutional ID</strong>”. We can do this by using the <a href="https://openalex.org/">OpenAlex website</a>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../media/open-alex/Screenshot 2025-03-04 at 8.05.28 AM.png" class="img-fluid figure-img"></p>
<figcaption>OpenAlex search</figcaption>
</figure>
</div>
<p>Click on the <strong>Institution</strong> button and start typing “Memorial University” into the OpenAlex search.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../media/open-alex/Screenshot 2025-03-04 at 8.05.52 AM.png" class="img-fluid figure-img"></p>
<figcaption>Search for Memorial University under “Institution”</figcaption>
</figure>
</div>
<p>Take a moment to review the results page – it’s the same page we saw when searching authors and topics in previous classes, only this time it’s for all of Memorial University. As of March 2025, there are almost 50,000 indexed publications.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../media/open-alex/Screenshot 2025-03-04 at 8.06.01 AM.png" class="img-fluid figure-img"></p>
<figcaption>The results page</figcaption>
</figure>
</div>
<p>Click on “Memorial University” in the search field.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../media/open-alex/Screenshot 2025-03-04 at 8.06.15 AM.png" class="img-fluid figure-img"></p>
<figcaption>Finding an Institutional ID</figcaption>
</figure>
</div>
<p>You should see an <strong>Institution ID</strong> under “Memorial University of Newfoundland.” I’ve highlighted it below to make it easier to see. <strong>This is the number we want to use when we query the OpenAlexAPI!</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../media/open-alex/Screenshot 2025-03-04 at 8.06.21 AM.png" class="img-fluid figure-img"></p>
<figcaption>Copying the Institutional ID for an API query</figcaption>
</figure>
</div>
<p>You can click to view MUN’s “Institutional Profile” on Open Alex.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../media/open-alex/Screenshot 2025-03-04 at 8.06.36 AM.png" class="img-fluid figure-img"></p>
<figcaption>An OpenAlex institution profile page</figcaption>
</figure>
</div>
</section>
<section id="query-the-openalex-api" class="level2">
<h2 class="anchored" data-anchor-id="query-the-openalex-api">Query the OpenAlex API</h2>
<p>Now we know that Memorial’s Institutional ID is <code>i130438778</code>. We can use this to setup an API query. Let’s start by creating a list with our query parameters.</p>
<p>Recall that a list in R is like a container that holds several pieces of information. In this case, our list will contain three key-value pairs:</p>
<ul>
<li><code>entity = "authors"</code> tells the API that we are interested in data about authors.</li>
<li><code>last_known_institutions.id = "i130438778"</code> specifies that we want authors who are or were affiliated with a particular institution (identified by “i130438778”).</li>
<li><code>works_count = "&gt;10"</code> means we want authors who have more than 10 published works.</li>
</ul>
<p>Let’s set it up!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>my_arguments <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">entity =</span> <span class="st">"authors"</span>,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">last_known_institutions.id =</span> <span class="st">"i130438778"</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">works_count =</span> <span class="st">"&gt;10"</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now let’s we’ll make an API call!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">do.call</span>(oa_fetch, <span class="fu">c</span>(my_arguments, <span class="fu">list</span>(<span class="at">count_only =</span> <span class="cn">TRUE</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     count db_response_time_ms page per_page
[1,]  2307                 169    1        1</code></pre>
</div>
</div>
<p><code>do.call()</code> is a function that calls another function – in this case <code>oa_fetch</code> – using a list of arguments.</p>
<p>Here, we combine our <code>my_arguments</code> list with an extra argument list<code>(count_only = TRUE)</code>. This tells the function <code>oa_fetch</code> to <em>only return a count</em> (the number of matching records) instead of all the detailed information OpenAlex has about our search results. Essentially, we’re asking the API: “<em>How many authors match these criteria?</em>”</p>
<p>So now we’ve defined the search criteria for authors in a list, and we’ve checked if there are any authors matching the criteria by asking for just a count. If there are results (i.e., there is 1 or more authors in the OpenAlex database), then we can make another request to collect detailed information for those authors.</p>
<p>Run the code block below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">do.call</span>(oa_fetch, <span class="fu">c</span>(my_arguments, <span class="fu">list</span>(<span class="at">count_only =</span> <span class="cn">TRUE</span>)))[<span class="dv">1</span>] <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">do.call</span>(oa_fetch, my_arguments) <span class="sc">|&gt;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">show_authors</span>() <span class="sc">|&gt;</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>        knitr<span class="sc">::</span><span class="fu">kable</span>()</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Unknown or uninitialised column: `name`.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Unknown or uninitialised column: `display_name`.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Unknown or uninitialised column: `name`.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Unknown or uninitialised column: `display_name`.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Unknown or uninitialised column: `name`.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Unknown or uninitialised column: `display_name`.</code></pre>
</div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 15%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">id</th>
<th style="text-align: left;">display_name</th>
<th style="text-align: left;">orcid</th>
<th style="text-align: right;">works_count</th>
<th style="text-align: right;">cited_by_count</th>
<th style="text-align: left;">affiliation_display_name</th>
<th style="text-align: left;">top_concepts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">A5026509039</td>
<td style="text-align: left;">Fereidoon Shahidi</td>
<td style="text-align: left;">0000-0002-9912-0330</td>
<td style="text-align: right;">1113</td>
<td style="text-align: right;">79559</td>
<td style="text-align: left;">Memorial University of Newfoundland</td>
<td style="text-align: left;">Biochemistry, Animal Science and Zoology, Molecular Biology</td>
</tr>
<tr class="even">
<td style="text-align: left;">A5077149719</td>
<td style="text-align: left;">Octavia A. Dobre</td>
<td style="text-align: left;">0000-0001-8528-0512</td>
<td style="text-align: right;">949</td>
<td style="text-align: right;">20777</td>
<td style="text-align: left;">Memorial University of Newfoundland</td>
<td style="text-align: left;">Electrical and Electronic Engineering, Electrical and Electronic Engineering, Electrical and Electronic Engineering</td>
</tr>
<tr class="odd">
<td style="text-align: left;">A5010428924</td>
<td style="text-align: left;">David C. Schneider</td>
<td style="text-align: left;">0000-0003-4771-2155</td>
<td style="text-align: right;">798</td>
<td style="text-align: right;">6532</td>
<td style="text-align: left;">Memorial University of Newfoundland</td>
<td style="text-align: left;">Global and Planetary Change, Insect Science, Ecology, Evolution, Behavior and Systematics</td>
</tr>
<tr class="even">
<td style="text-align: left;">A5049089848</td>
<td style="text-align: left;">Trung Q. Duong</td>
<td style="text-align: left;">0000-0002-4703-4836</td>
<td style="text-align: right;">726</td>
<td style="text-align: right;">18629</td>
<td style="text-align: left;">Memorial University of Newfoundland</td>
<td style="text-align: left;">Electrical and Electronic Engineering, Computer Networks and Communications, Electrical and Electronic Engineering</td>
</tr>
<tr class="odd">
<td style="text-align: left;">A5032069177</td>
<td style="text-align: left;">Ian Fleming</td>
<td style="text-align: left;">0000-0002-5541-824X</td>
<td style="text-align: right;">701</td>
<td style="text-align: right;">23299</td>
<td style="text-align: left;">Memorial University of Newfoundland</td>
<td style="text-align: left;">Organic Chemistry, Organic Chemistry, Nature and Landscape Conservation</td>
</tr>
<tr class="even">
<td style="text-align: left;">A5102982237</td>
<td style="text-align: left;">Robert A. Brown</td>
<td style="text-align: left;">0000-0003-2350-110X</td>
<td style="text-align: right;">528</td>
<td style="text-align: right;">18534</td>
<td style="text-align: left;">Memorial University of Newfoundland</td>
<td style="text-align: left;">Materials Chemistry, Astronomy and Astrophysics, Astronomy and Astrophysics</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>In the code above, we check if the count returned by the previous call is greater than zero by using an <code>if</code> statement. Then <code>do.call(oa_fetch, c(my_arguments, list(count_only = TRUE)))[1]</code> retrieves the first element of the result, which is the number of matching authors. If that number is greater than 0 (meaning there is at least one author that meets the criteria), then the code inside the <code>if</code> block (<code>{ ... }</code>) block will run.</p>
<p>Inside the <code>if</code> block, <code>do.call(oa_fetch, my_arguments)</code> calls the <code>oa_fetch</code> function again with our original arguments, only this time we don’t use <code>count_only = TRUE</code>. This tells to API to fetch all the details of the matching authors. We then use the pipe operator <code>|&gt;</code> to pass the results of that function on to the next function, <code>show_authors()</code>. The <code>show_authors()</code> function formats or selects relevant author information. Finally, we pass the formatted data to <code>knitr::kable()</code>, which converts it into a nicely formatted table.</p>
</section>
<section id="store-the-data" class="level2">
<h2 class="anchored" data-anchor-id="store-the-data">Store the Data!</h2>
<p>So far our code fetches data and processes it for display, but it doesn’t retain the data in memory or write it to disk. If we want to keep it in memory and <em>analyze</em> that data in some way, we need to assign the result to a variable. Recall from previous classes that we want to minimize our APIs calls to be considerate of the servers providing our data.</p>
<p>Let’s do that now, making yet another API call.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>authors_data <span class="ot">&lt;-</span> <span class="fu">do.call</span>(oa_fetch, my_arguments)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now our data in stored in <code>authors_data</code>. Let’s take a look at the column names.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(authors_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "id"                        "display_name"             
 [3] "display_name_alternatives" "ids"                      
 [5] "orcid"                     "works_count"              
 [7] "cited_by_count"            "counts_by_year"           
 [9] "affiliation_display_name"  "affiliation_id"           
[11] "affiliation_ror"           "affiliation_country_code" 
[13] "affiliation_type"          "affiliation_lineage"      
[15] "affiliations_other"        "topics"                   
[17] "works_api_url"            </code></pre>
</div>
</div>
<p>There are 17 variables for us to work with here! We’ll focus on a few today, including <code>display_name</code>, <code>cited_by_count</code>, <code>works_count</code>, <code>counts_by_year</code>, and <code>topics</code>.</p>
<p>We can print a preview of the <code>tibble</code> like any other. Let’s print 30 rows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(authors_data, <span class="at">n =</span> <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,307 × 17
   id                display_name display_name_alterna…¹ ids   orcid works_count
   &lt;chr&gt;             &lt;chr&gt;        &lt;list&gt;                 &lt;lis&gt; &lt;chr&gt;       &lt;int&gt;
 1 https://openalex… Fereidoon S… &lt;chr [3]&gt;              &lt;chr&gt; http…        1113
 2 https://openalex… Octavia A. … &lt;chr [7]&gt;              &lt;chr&gt; http…         949
 3 https://openalex… David C. Sc… &lt;chr [6]&gt;              &lt;chr&gt; http…         798
 4 https://openalex… Trung Q. Du… &lt;chr [5]&gt;              &lt;chr&gt; http…         726
 5 https://openalex… Ian Fleming  &lt;chr [8]&gt;              &lt;chr&gt; http…         701
 6 https://openalex… Robert A. B… &lt;chr [6]&gt;              &lt;chr&gt; http…         528
 7 https://openalex… Weimin Huang &lt;chr [10]&gt;             &lt;chr&gt; http…         525
 8 https://openalex… Laurence K.… &lt;chr [6]&gt;              &lt;chr&gt; &lt;NA&gt;          523
 9 https://openalex… G.F. Naterer &lt;chr [4]&gt;              &lt;chr&gt; http…         523
10 https://openalex… Proton Rahm… &lt;chr [5]&gt;              &lt;chr&gt; http…         492
11 https://openalex… David G. Be… &lt;chr [6]&gt;              &lt;chr&gt; http…         485
12 https://openalex… David Molyn… &lt;chr [6]&gt;              &lt;chr&gt; http…         478
13 https://openalex… Lynn H. Ger… &lt;chr [13]&gt;             &lt;chr&gt; http…         454
14 https://openalex… M. P. Searle &lt;chr [9]&gt;              &lt;chr&gt; http…         434
15 https://openalex… Baiyu Zhang  &lt;chr [9]&gt;              &lt;chr&gt; http…         430
16 https://openalex… Steven M. R… &lt;chr [8]&gt;              &lt;chr&gt; http…         424
17 https://openalex… Rosemary Ri… &lt;chr [5]&gt;              &lt;chr&gt; http…         412
18 https://openalex… E. Jacobsen  &lt;chr [4]&gt;              &lt;chr&gt; &lt;NA&gt;          394
19 https://openalex… Lev Tarasov  &lt;chr [4]&gt;              &lt;chr&gt; http…         390
20 https://openalex… Sohrab Zend… &lt;chr [3]&gt;              &lt;chr&gt; http…         376
21 https://openalex… Patrick S. … &lt;chr [5]&gt;              &lt;chr&gt; http…         348
22 https://openalex… Neil Bose    &lt;chr [7]&gt;              &lt;chr&gt; http…         344
23 https://openalex… Jian‐Bin Lin &lt;chr [4]&gt;              &lt;chr&gt; http…         336
24 https://openalex… John T. Bro… &lt;chr [5]&gt;              &lt;chr&gt; http…         332
25 https://openalex… Jie Xiao     &lt;chr [5]&gt;              &lt;chr&gt; http…         318
26 https://openalex… Yuming Zhao  &lt;chr [4]&gt;              &lt;chr&gt; http…         317
27 https://openalex… M. Tariq Iq… &lt;chr [15]&gt;             &lt;chr&gt; http…         315
28 https://openalex… Michael Lei… &lt;chr [3]&gt;              &lt;chr&gt; http…         308
29 https://openalex… Abir U. Iga… &lt;chr [6]&gt;              &lt;chr&gt; http…         300
30 https://openalex… Rachel Berk… &lt;chr [5]&gt;              &lt;chr&gt; http…         299
# ℹ 2,277 more rows
# ℹ abbreviated name: ¹​display_name_alternatives
# ℹ 11 more variables: cited_by_count &lt;int&gt;, counts_by_year &lt;list&gt;,
#   affiliation_display_name &lt;chr&gt;, affiliation_id &lt;chr&gt;,
#   affiliation_ror &lt;chr&gt;, affiliation_country_code &lt;chr&gt;,
#   affiliation_type &lt;chr&gt;, affiliation_lineage &lt;chr&gt;,
#   affiliations_other &lt;list&gt;, topics &lt;list&gt;, works_api_url &lt;chr&gt;</code></pre>
</div>
</div>
<p>Let’s take a look at the <code>topics</code> data first. We’ll get a sense of what is in here and think about how to filter it to a smaller set of results that interest us.</p>
<p>One way to proceed is to use the <code>pull()</code> function from the <code>tidyverse</code>. If you run the code below, you’ll see a LOT of text populate your screen – R is printing 2307 dataframes! I won’t print the results here, but you can!</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>authors_data <span class="sc">%&gt;%</span> <span class="fu">pull</span>(topics)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>When we we pipe <code>authors_data</code> into <code>pull(topics)</code>, we get the contents of the <code>topics</code> column as a <code>vector</code>. Vectors are useful for lots of things, including quick computations, plotting, or applying vectorized functions. Since it’s a simple vector, there’s no extra metadata like column names or row indices.</p>
<p>That’s not always what we want. Instead, we could use the <code>select()</code> function from the <code>tidyverse</code> to get back a <code>tibble</code> containing the column we want. Because it’s a <code>tibble</code>, <em>it preserves additional information such as column names, types, and row names</em> (implicitly). The <code>tibble</code> still has the structure of a table, so we can see the column name and work with it in the context of other columns! And keeping our data in a <code>tibble</code> format makes it easier to perform further data manipulations, or join with other <code>tibbles</code>, since many tidyverse functions expect data to be in a <code>tibble</code> format.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>authors_data <span class="sc">%&gt;%</span> <span class="fu">select</span>(topics)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This is a complex data structure! Each publication in our dataset has a <code>tibble</code> stored in the <code>topics</code> column! Nested dataframes! Oh my.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>authors_data <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(topics) <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    .[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 100 × 5
       i count name     id                                  display_name        
   &lt;int&gt; &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;                               &lt;chr&gt;               
 1     1   312 topic    https://openalex.org/T10035         Phytochemicals and …
 2     1   312 subfield https://openalex.org/subfields/2704 Biochemistry        
 3     1   312 field    https://openalex.org/fields/27      Medicine            
 4     1   312 domain   https://openalex.org/domains/4      Health Sciences     
 5     2   228 topic    https://openalex.org/T10333         Meat and Animal Pro…
 6     2   228 subfield https://openalex.org/subfields/1103 Animal Science and …
 7     2   228 field    https://openalex.org/fields/11      Agricultural and Bi…
 8     2   228 domain   https://openalex.org/domains/1      Life Sciences       
 9     3   165 topic    https://openalex.org/T11561         Protein Hydrolysis …
10     3   165 subfield https://openalex.org/subfields/1312 Molecular Biology   
# ℹ 90 more rows

[[2]]
# A tibble: 100 × 5
       i count name     id                                  display_name        
   &lt;int&gt; &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;                               &lt;chr&gt;               
 1     1   303 topic    https://openalex.org/T11458         Advanced Wireless C…
 2     1   303 subfield https://openalex.org/subfields/2208 Electrical and Elec…
 3     1   303 field    https://openalex.org/fields/22      Engineering         
 4     1   303 domain   https://openalex.org/domains/3      Physical Sciences   
 5     2   186 topic    https://openalex.org/T10148         Advanced MIMO Syste…
 6     2   186 subfield https://openalex.org/subfields/2208 Electrical and Elec…
 7     2   186 field    https://openalex.org/fields/22      Engineering         
 8     2   186 domain   https://openalex.org/domains/3      Physical Sciences   
 9     3   116 topic    https://openalex.org/T10851         Optical Wireless Co…
10     3   116 subfield https://openalex.org/subfields/2208 Electrical and Elec…
# ℹ 90 more rows

[[3]]
# A tibble: 100 × 5
       i count name     id                                  display_name        
   &lt;int&gt; &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;                               &lt;chr&gt;               
 1     1    57 topic    https://openalex.org/T10230         Marine and fisherie…
 2     1    57 subfield https://openalex.org/subfields/2306 Global and Planetar…
 3     1    57 field    https://openalex.org/fields/23      Environmental Scien…
 4     1    57 domain   https://openalex.org/domains/3      Physical Sciences   
 5     2    53 topic    https://openalex.org/T10135         Insect-Plant Intera…
 6     2    53 subfield https://openalex.org/subfields/1109 Insect Science      
 7     2    53 field    https://openalex.org/fields/11      Agricultural and Bi…
 8     2    53 domain   https://openalex.org/domains/1      Life Sciences       
 9     3    35 topic    https://openalex.org/T12329         Hemiptera Insect St…
10     3    35 subfield https://openalex.org/subfields/1105 Ecology, Evolution,…
# ℹ 90 more rows

[[4]]
# A tibble: 100 × 5
       i count name     id                                  display_name        
   &lt;int&gt; &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;                               &lt;chr&gt;               
 1     1   265 topic    https://openalex.org/T10148         Advanced MIMO Syste…
 2     1   265 subfield https://openalex.org/subfields/2208 Electrical and Elec…
 3     1   265 field    https://openalex.org/fields/22      Engineering         
 4     1   265 domain   https://openalex.org/domains/3      Physical Sciences   
 5     2   261 topic    https://openalex.org/T10796         Cooperative Communi…
 6     2   261 subfield https://openalex.org/subfields/1705 Computer Networks a…
 7     2   261 field    https://openalex.org/fields/17      Computer Science    
 8     2   261 domain   https://openalex.org/domains/3      Physical Sciences   
 9     3   161 topic    https://openalex.org/T11458         Advanced Wireless C…
10     3   161 subfield https://openalex.org/subfields/2208 Electrical and Elec…
# ℹ 90 more rows

[[5]]
# A tibble: 100 × 5
       i count name     id                                  display_name        
   &lt;int&gt; &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;                               &lt;chr&gt;               
 1     1   210 topic    https://openalex.org/T10013         Asymmetric Synthesi…
 2     1   210 subfield https://openalex.org/subfields/1605 Organic Chemistry   
 3     1   210 field    https://openalex.org/fields/16      Chemistry           
 4     1   210 domain   https://openalex.org/domains/3      Physical Sciences   
 5     2   165 topic    https://openalex.org/T11549         Synthetic Organic C…
 6     2   165 subfield https://openalex.org/subfields/1605 Organic Chemistry   
 7     2   165 field    https://openalex.org/fields/16      Chemistry           
 8     2   165 domain   https://openalex.org/domains/3      Physical Sciences   
 9     3   133 topic    https://openalex.org/T10302         Fish Ecology and Ma…
10     3   133 subfield https://openalex.org/subfields/2309 Nature and Landscap…
# ℹ 90 more rows

[[6]]
# A tibble: 100 × 5
       i count name     id                                  display_name        
   &lt;int&gt; &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;                               &lt;chr&gt;               
 1     1    86 topic    https://openalex.org/T11087         Solidification and …
 2     1    86 subfield https://openalex.org/subfields/2505 Materials Chemistry 
 3     1    86 field    https://openalex.org/fields/25      Materials Science   
 4     1    86 domain   https://openalex.org/domains/3      Physical Sciences   
 5     2    69 topic    https://openalex.org/T10039         Stellar, planetary,…
 6     2    69 subfield https://openalex.org/subfields/3103 Astronomy and Astro…
 7     2    69 field    https://openalex.org/fields/31      Physics and Astrono…
 8     2    69 domain   https://openalex.org/domains/3      Physical Sciences   
 9     3    68 topic    https://openalex.org/T10325         Astro and Planetary…
10     3    68 subfield https://openalex.org/subfields/3103 Astronomy and Astro…
# ℹ 90 more rows

[[7]]
# A tibble: 100 × 5
       i count name     id                                  display_name        
   &lt;int&gt; &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;                               &lt;chr&gt;               
 1     1   188 topic    https://openalex.org/T11061         Ocean Waves and Rem…
 2     1   188 subfield https://openalex.org/subfields/1910 Oceanography        
 3     1   188 field    https://openalex.org/fields/19      Earth and Planetary…
 4     1   188 domain   https://openalex.org/domains/3      Physical Sciences   
 5     2   107 topic    https://openalex.org/T10891         Radar Systems and S…
 6     2   107 subfield https://openalex.org/subfields/2202 Aerospace Engineeri…
 7     2   107 field    https://openalex.org/fields/22      Engineering         
 8     2   107 domain   https://openalex.org/domains/3      Physical Sciences   
 9     3    93 topic    https://openalex.org/T10255         Oceanographic and A…
10     3    93 subfield https://openalex.org/subfields/1910 Oceanography        
# ℹ 90 more rows

[[8]]
# A tibble: 100 × 5
       i count name     id                                  display_name        
   &lt;int&gt; &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;                               &lt;chr&gt;               
 1     1   242 topic    https://openalex.org/T10612         Magnetism in coordi…
 2     1   242 subfield https://openalex.org/subfields/2504 Electronic, Optical…
 3     1   242 field    https://openalex.org/fields/25      Materials Science   
 4     1   242 domain   https://openalex.org/domains/3      Physical Sciences   
 5     2   216 topic    https://openalex.org/T11881         Crystallization and…
 6     2   216 subfield https://openalex.org/subfields/2505 Materials Chemistry 
 7     2   216 field    https://openalex.org/fields/25      Materials Science   
 8     2   216 domain   https://openalex.org/domains/3      Physical Sciences   
 9     3   215 topic    https://openalex.org/T12613         X-ray Diffraction i…
10     3   215 subfield https://openalex.org/subfields/2505 Materials Chemistry 
# ℹ 90 more rows

[[9]]
# A tibble: 100 × 5
       i count name     id                                  display_name        
   &lt;int&gt; &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;                               &lt;chr&gt;               
 1     1   120 topic    https://openalex.org/T11802         Chemical Looping an…
 2     1   120 subfield https://openalex.org/subfields/2204 Biomedical Engineer…
 3     1   120 field    https://openalex.org/fields/22      Engineering         
 4     1   120 domain   https://openalex.org/domains/3      Physical Sciences   
 5     2    78 topic    https://openalex.org/T10998         Heat Transfer and O…
 6     2    78 subfield https://openalex.org/subfields/2210 Mechanical Engineer…
 7     2    78 field    https://openalex.org/fields/22      Engineering         
 8     2    78 domain   https://openalex.org/domains/3      Physical Sciences   
 9     3    54 topic    https://openalex.org/T12696         Icing and De-icing …
10     3    54 subfield https://openalex.org/subfields/2202 Aerospace Engineeri…
# ℹ 90 more rows

[[10]]
# A tibble: 100 × 5
       i count name     id                                  display_name        
   &lt;int&gt; &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;                               &lt;chr&gt;               
 1     1   250 topic    https://openalex.org/T11092         Spondyloarthritis S…
 2     1   250 subfield https://openalex.org/subfields/2745 Rheumatology        
 3     1   250 field    https://openalex.org/fields/27      Medicine            
 4     1   250 domain   https://openalex.org/domains/4      Health Sciences     
 5     2   211 topic    https://openalex.org/T10469         Psoriasis: Treatmen…
 6     2   211 subfield https://openalex.org/subfields/2403 Immunology          
 7     2   211 field    https://openalex.org/fields/24      Immunology and Micr…
 8     2   211 domain   https://openalex.org/domains/1      Life Sciences       
 9     3   178 topic    https://openalex.org/T10200         Rheumatoid Arthriti…
10     3   178 subfield https://openalex.org/subfields/2745 Rheumatology        
# ℹ 90 more rows</code></pre>
</div>
</div>
<p>If we print some rows from the topics <code>tibble</code>, we can see that it contains information on <code>topic</code>, <code>subfield</code>, <code>field</code>, and <code>domain</code>. We’ll focus on topics for now and will come back to fields later.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>authors_data <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(topics) <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(topics) <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">distinct</span>(display_name) <span class="sc">%&gt;%</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4,285 × 1
   display_name                                
   &lt;chr&gt;                                       
 1 Phytochemicals and Antioxidant Activities   
 2 Biochemistry                                
 3 Medicine                                    
 4 Health Sciences                             
 5 Meat and Animal Product Quality             
 6 Animal Science and Zoology                  
 7 Agricultural and Biological Sciences        
 8 Life Sciences                               
 9 Protein Hydrolysis and Bioactive Peptides   
10 Molecular Biology                           
11 Biochemistry, Genetics and Molecular Biology
12 Antioxidant Activity and Oxidative Stress   
13 Fatty Acid Research and Health              
14 Nutrition and Dietetics                     
15 Nursing                                     
16 Edible Oils Quality and Analysis            
17 Organic Chemistry                           
18 Chemistry                                   
19 Physical Sciences                           
20 Aquaculture Nutrition and Growth            
21 Aquatic Science                             
22 Free Radicals and Antioxidants              
23 Advanced Chemical Sensor Technologies       
24 Biomedical Engineering                      
25 Engineering                                 
26 Tea Polyphenols and Effects                 
27 Pathology and Forensic Medicine             
28 Nuts composition and effects                
29 Phytoestrogen effects and research          
30 Food Chemistry and Fat Analysis             
# ℹ 4,255 more rows</code></pre>
</div>
</div>
<p>Let’s filter the <code>tibble</code> to find authors (rows in <code>authors_data</code>) who have worked on the topic of “migration.”</p>
<p>Let’s unpack the code below.</p>
<p>First, we create a variable called <code>search_topic</code> and assign it the string “migration”. We will use this value later to filter the data. Then we pipe the <code>authors_data</code> into the <code>select()</code> function, where we select the <code>display_name</code> column (containing author names) and the <code>topics</code> column, which contained nested tibbles with information about the topics on which a specific author has published.</p>
<p>We then pipe the author names and topics into the <code>unnest()</code> function, which <em>unnests</em> the <code>topics</code> column. In other words, we will pull the <code>topics</code> <code>tibble</code> out of the row from the <code>dataframe</code> and expand it so that it is it’s own <code>tibble</code> with separate rows. The <code>names_sep = "_"</code> parameter specifies that* when unnesting, any new column names coming from the nested structure should be concatenated with the original column name using an underscore.* For example, if the nested <code>tibble</code> has a column named <code>display_name</code>, it might become <code>topics_display_name</code>. Why does that matter? Because the nested <code>tibble</code> has columns with the same names as the <code>tibble</code> it’s embedded in, which can cause… chaos.</p>
<p>Next, we pipe the unnested data into the <code>filter()</code> function. We use it to filter the rows in <code>author_data</code> based on whether the <code>topics_display_name</code> column contains the text stored in <code>search_topic</code> (which is “migration”). To make that happen, we use the <code>str_detect()</code> function to check if a string contains a specific pattern. We use a “regular expression” that ignores case differences by using the argument <code>ignore_case = TRUE</code> (so “Migration” or “migration” both match).</p>
<p>Now we can display a list of unique authors who meet our search and filter criteria by piping the results into <code>distinct()</code> and then printing the first <code>n</code> results (in this case, 80).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>search_topic <span class="ot">&lt;-</span> <span class="st">"migration"</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>authors_data <span class="sc">%&gt;%</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(display_name, topics) <span class="sc">%&gt;%</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(topics, <span class="at">names_sep =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">str_detect</span>(topics_display_name, <span class="fu">regex</span>(search_topic, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">distinct</span>(display_name) <span class="sc">%&gt;%</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">80</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 160 × 1
   display_name             
   &lt;chr&gt;                    
 1 Sian Neilson             
 2 Roger White              
 3 Ratana Chuenpagdee       
 4 Tony Fang                
 5 Trevor Bell              
 6 Lewis R. Fischer         
 7 Eric Y. Tenkorang        
 8 Barbara Neis             
 9 R. J. Avery              
10 Yang Zhen                
11 Amin A. Muhammad Gadit   
12 Ashlee Cunsolo           
13 Derek Nurse              
14 Mark C. J. Stoddart      
15 Kelly Vodden             
16 Stephen Bornstein        
17 Lisa Philpott            
18 Marilyn Porter           
19 Shree Mulay              
20 Tyler D. Eddy            
21 Yanqing Yi               
22 Diana L. Gustafson       
23 Alex Stewart             
24 Ben Burt                 
25 A. Lukyn Williams        
26 Sharon R. Roseman        
27 Jennifer A. Selby        
28 Gillian Kolla            
29 Sulaimon Gıwa            
30 Diane Tye                
31 Victor Maddalena         
32 Christopher P. Youé      
33 Fern Brunger             
34 KL MacPherson            
35 David Close              
36 Sonja Boon               
37 T.E. Roche               
38 Robert Ormsby            
39 Benjamin Rich Zendel     
40 Jane G. Zhu              
41 Adrian Tanner            
42 Lisa Rankin              
43 Alexander Y. Shestopaloff
44 Stephen Czarnuch         
45 Dale Kirby               
46 Martha Traverso-Yépez    
47 María Andrée López Gómez 
48 Nancy Pedri              
49 Rick Audas               
50 Alan Hall                
51 M. J. Anderson           
52 Delores V. Mullings      
53 Rochelle R. Côté         
54 Gordon B. Cooke          
55 Roselyne N. Okech        
56 Bill Bigelow             
57 Isabelle Côté            
58 Gerald Mugford           
59 Katherine Side           
60 Nicholas Wells           
61 Jaro Stacul              
62 Maisam Najafizada        
63 Susan Stuckless          
64 Peter Narváez            
65 Jean L. Briggs           
66 Pauline Duke             
67 Sarah Gander             
68 Ahmed Afzal              
69 Yorck Sommerhäuser       
70 Natalie Beausoleil       
71 Rainer Baehre            
72 Valerie Burton           
73 Frederick Johnstone      
74 Yolande Pottie‐Sherman   
75 Nathalie LaCoste         
76 Hollý                    
77 Hugh Whalen              
78 Lisa‐Jo K. van den Scott 
79 Martin Lovelace          
80 Jeanne Sinclair          
# ℹ 80 more rows</code></pre>
</div>
</div>
<p>What are we looking at here? These are authors affiliated with Memorial University who have published <em>at least one</em> paper on the topic of “migration.” It also prints the author’s number of publications and citations (as indexed by OpenAlex). We got that data by developing a small pipeline that:</p>
<ol type="1">
<li>Starts with our original dataset.</li>
<li>Focuses on just the author names and their topics.</li>
<li>Expands nested topic information into individual rows.</li>
<li>Filters rows where the topic matches “migration”.</li>
<li>Removes duplicate author names.</li>
<li>Prints the results, showing up to 80 rows.</li>
</ol>
<p>Now… change the <code>search_topic</code> above to search for other topics. Try “climate change” (or whatever)!</p>
</section>
<section id="more-than-names" class="level2">
<h2 class="anchored" data-anchor-id="more-than-names">More than Names</h2>
<!-- This is great, but maybe we also want to see some other information. We'll modify our pipeline to also include information about the number of works published and the number of citations those works have received.  -->
<p>OK, cool! But, once again, maybe we want to see some other information, like maybe the name of the author, the title of the publication, and the number of topics assigned to that publication. Let’s do that below and print the top 200 results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>search_topic <span class="ot">&lt;-</span> <span class="st">"migration"</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>authors_data <span class="sc">%&gt;%</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(display_name, topics, works_count, cited_by_count) <span class="sc">%&gt;%</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(topics, <span class="at">names_sep =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">str_detect</span>(topics_display_name, <span class="fu">regex</span>(search_topic, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(display_name, topics_display_name, topics_count, topics_display_name) <span class="sc">%&gt;%</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">200</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 207 × 3
    display_name                topics_display_name                 topics_count
    &lt;chr&gt;                       &lt;chr&gt;                                      &lt;int&gt;
  1 Sian Neilson                European Law and Migration                     4
  2 Sian Neilson                Human Rights and Immigration                   3
  3 Roger White                 Migration and Labor Dynamics                  31
  4 Roger White                 Migration, Ethnicity, and Economy             25
  5 Ratana Chuenpagdee          Climate Change, Adaptation, Migrat…            5
  6 Tony Fang                   Migration and Labor Dynamics                  30
  7 Tony Fang                   Migration, Ethnicity, and Economy             27
  8 Tony Fang                   Diaspora, migration, transnational…            5
  9 Trevor Bell                 Climate Change, Adaptation, Migrat…            4
 10 Lewis R. Fischer            Migration, Policy, and Dickens Stu…            1
 11 Eric Y. Tenkorang           Migration and Labor Dynamics                   3
 12 Eric Y. Tenkorang           Migration, Health and Trauma                   2
 13 Barbara Neis                Migration, Aging, and Tourism Stud…            9
 14 Barbara Neis                Migration and Labor Dynamics                   4
 15 R. J. Avery                 Migration, Aging, and Tourism Stud…            4
 16 Yang Zhen                   China's Global Influence and Migra…            1
 17 Amin A. Muhammad Gadit      Migration, Health and Trauma                   4
 18 Ashlee Cunsolo              Climate Change, Adaptation, Migrat…            9
 19 Derek Nurse                 Diaspora, migration, transnational…            1
 20 Mark C. J. Stoddart         Climate Change, Adaptation, Migrat…            3
 21 Kelly Vodden                Migration, Aging, and Tourism Stud…            5
 22 Stephen Bornstein           Migration, Health and Trauma                   2
 23 Lisa Philpott               Migration, Ethnicity, and Economy              2
 24 Marilyn Porter              Migration, Ethnicity, and Economy              5
 25 Marilyn Porter              Migration and Labor Dynamics                   3
 26 Shree Mulay                 Migration, Health and Trauma                   3
 27 Tyler D. Eddy               Climate Change, Adaptation, Migrat…            3
 28 Yanqing Yi                  Migration, Health and Trauma                   7
 29 Diana L. Gustafson          Migration, Health and Trauma                   9
 30 Alex Stewart                Migration, Ethnicity, and Economy             14
 31 Ben Burt                    Climate Change, Adaptation, Migrat…            6
 32 Ben Burt                    Italian Social Issues and Migration            1
 33 Ben Burt                    Diaspora, migration, transnational…            1
 34 A. Lukyn Williams           European Law and Migration                     2
 35 Sharon R. Roseman           Migration, Aging, and Tourism Stud…           12
 36 Sharon R. Roseman           Migration and Labor Dynamics                   6
 37 Sharon R. Roseman           Migration, Ethnicity, and Economy              5
 38 Sharon R. Roseman           Diaspora, migration, transnational…            4
 39 Sharon R. Roseman           Immigration and Intercultural Educ…            2
 40 Sharon R. Roseman           Migration, Refugees, and Integrati…            2
 41 Jennifer A. Selby           Multiculturalism, Politics, Migrat…           29
 42 Jennifer A. Selby           Migration, Identity, and Health                3
 43 Gillian Kolla               Migration, Health and Trauma                   2
 44 Sulaimon Gıwa               Migration and Labor Dynamics                   5
 45 Sulaimon Gıwa               Migration, Ethnicity, and Economy              4
 46 Sulaimon Gıwa               Migration, Health and Trauma                   3
 47 Sulaimon Gıwa               Migration, Refugees, and Integrati…            3
 48 Sulaimon Gıwa               Migration, Identity, and Health                2
 49 Diane Tye                   Migration, Ethnicity, and Economy              1
 50 Victor Maddalena            Migration, Health and Trauma                   2
 51 Christopher P. Youé         Migration, Ethnicity, and Economy              1
 52 Fern Brunger                Migration, Health and Trauma                   3
 53 KL MacPherson               China's Global Influence and Migra…            2
 54 David Close                 Diaspora, migration, transnational…            2
 55 Sonja Boon                  Migration, Ethnicity, and Economy              2
 56 T.E. Roche                  Macrophage Migration Inhibitory Fa…            2
 57 Robert Ormsby               Migration, Policy, and Dickens Stu…            1
 58 Benjamin Rich Zendel        Migration, Aging, and Tourism Stud…            1
 59 Jane G. Zhu                 Migration, Ethnicity, and Economy              2
 60 Adrian Tanner               Multiculturalism, Politics, Migrat…            2
 61 Adrian Tanner               Climate Change, Adaptation, Migrat…            1
 62 Lisa Rankin                 Migration, Aging, and Tourism Stud…            1
 63 Alexander Y. Shestopaloff   Migration, Health and Trauma                   2
 64 Stephen Czarnuch            Migration, Health and Trauma                   2
 65 Dale Kirby                  Migration, Ethnicity, and Economy              2
 66 Dale Kirby                  Migration and Labor Dynamics                   2
 67 Martha Traverso-Yépez       Migration, Racism, and Human Rights            2
 68 María Andrée López Gómez    Migration, Aging, and Tourism Stud…            2
 69 Nancy Pedri                 Diaspora, migration, transnational…            1
 70 Rick Audas                  Migration and Labor Dynamics                   2
 71 Alan Hall                   Migration, Identity, and Health                1
 72 M. J. Anderson              Macrophage Migration Inhibitory Fa…            1
 73 Delores V. Mullings         Migration and Labor Dynamics                   6
 74 Delores V. Mullings         Migration, Health and Trauma                   4
 75 Delores V. Mullings         Migration, Ethnicity, and Economy              3
 76 Rochelle R. Côté            Migration, Ethnicity, and Economy              6
 77 Rochelle R. Côté            Migration and Labor Dynamics                   3
 78 Gordon B. Cooke             Migration, Aging, and Tourism Stud…            2
 79 Roselyne N. Okech           Migration, Ethnicity, and Economy              2
 80 Bill Bigelow                Migration, Ethnicity, and Economy              1
 81 Isabelle Côté               Migration and Labor Dynamics                   4
 82 Isabelle Côté               Migration, Refugees, and Integrati…            4
 83 Isabelle Côté               Diaspora, migration, transnational…            2
 84 Isabelle Côté               Migration, Identity, and Health                1
 85 Gerald Mugford              Migration, Aging, and Tourism Stud…            2
 86 Katherine Side              Migration, Refugees, and Integrati…            4
 87 Nicholas Wells              Migration, Aging, and Tourism Stud…            2
 88 Jaro Stacul                 Italian Social Issues and Migration            1
 89 Maisam Najafizada           Migration, Health and Trauma                   2
 90 Susan Stuckless             Migration, Aging, and Tourism Stud…            1
 91 Peter Narváez               Migration, Ethnicity, and Economy              1
 92 Jean L. Briggs              Migration, Education, Indigenous S…            2
 93 Pauline Duke                Migration, Health and Trauma                   2
 94 Sarah Gander                Migration, Health and Trauma                   4
 95 Ahmed Afzal                 Diaspora, migration, transnational…            3
 96 Ahmed Afzal                 Migration and Labor Dynamics                   2
 97 Ahmed Afzal                 Migration, Ethnicity, and Economy              2
 98 Yorck Sommerhäuser          Migration, Ethnicity, and Economy              1
 99 Natalie Beausoleil          Multiculturalism, Politics, Migrat…            1
100 Rainer Baehre               Migration, Ethnicity, and Economy              1
101 Rainer Baehre               Migration and Labor Dynamics                   1
102 Valerie Burton              Migration, Ethnicity, and Economy              3
103 Frederick Johnstone         Migration, Ethnicity, and Economy              3
104 Yolande Pottie‐Sherman      Migration and Labor Dynamics                   7
105 Yolande Pottie‐Sherman      Migration, Ethnicity, and Economy              6
106 Yolande Pottie‐Sherman      Migration, Refugees, and Integrati…            5
107 Yolande Pottie‐Sherman      Diaspora, migration, transnational…            3
108 Yolande Pottie‐Sherman      Migration, Aging, and Tourism Stud…            3
109 Nathalie LaCoste            Multiculturalism, Politics, Migrat…            1
110 Hollý                       Migration and Labor Dynamics                   1
111 Hugh Whalen                 Multiculturalism, Politics, Migrat…            1
112 Lisa‐Jo K. van den Scott    Diaspora, migration, transnational…            1
113 Martin Lovelace             Migration, Ethnicity, and Economy              1
114 Jeanne Sinclair             Migration, Aging, and Tourism Stud…            1
115 Christopher Patey           Italian Social Issues and Migration            1
116 Dominique Brégent‐Heald     Migration, Health, Geopolitics, Hi…            2
117 Daze Jefferies              Migration, Ethnicity, and Economy              1
118 David Peddle                Human Rights and Immigration                   1
119 Stephen Harold Riggins      Diaspora, migration, transnational…            2
120 Stephen Harold Riggins      Migration, Ethnicity, and Economy              1
121 James Valcour               Climate Change, Adaptation, Migrat…            1
122 Mercedes Steedman           Migration, Ethnicity, and Economy              2
123 Ivan Emke                   European Law and Migration                     1
124 Ivan Emke                   Migration, Health and Trauma                   1
125 Robin Whitaker              Migration, Refugees, and Integrati…            4
126 Robin Whitaker              Multiculturalism, Politics, Migrat…            1
127 Lincoln Addison             Migration, Ethnicity, and Economy              3
128 Lincoln Addison             Migration and Labor Dynamics                   1
129 Elizabeth Yeoman            Migration, Refugees, and Integrati…            1
130 Alessandro Giardino         Multiculturalism, Politics, Migrat…            1
131 D. Codner                   Macrophage Migration Inhibitory Fa…            1
132 Lesley Butler               Diaspora, migration, transnational…            1
133 Lesley Butler               Migration, Ethnicity, and Economy              1
134 Lesley Butler               Climate Change, Adaptation, Migrat…            1
135 Julia Temple Newhook        Migration, Ethnicity, and Economy              1
136 Julia Temple Newhook        Migration and Labor Dynamics                   1
137 Donald W. Nichol            Migration, Policy, and Dickens Stu…            1
138 John Mannion                Climate Change, Adaptation, Migrat…            1
139 Santé A. Viselli            Multiculturalism, Politics, Migrat…            1
140 Ronald Schwartz             Diaspora, migration, transnational…            1
141 Brenda A. LeFrançois        Labour Market and Migration                    1
142 Roza Tchoukaleyska          Migration, Identity, and Health                1
143 Heidi Coombs-Thorne         Migration and Labor Dynamics                   1
144 Robert Shea                 Migration, Refugees, and Integrati…            1
145 Paul Alhassan Issahaku      Migration, Health and Trauma                   1
146 Amy M. Warren               Migration, Aging, and Tourism Stud…            1
147 Rowena Mercado              Migration, Health and Trauma                   1
148 Kwamina Abekah‐Carter       Migration, Aging, and Tourism Stud…            2
149 Angela J. Hyde              Macrophage Migration Inhibitory Fa…            1
150 Sylvia Moore                Climate Change, Adaptation, Migrat…            1
151 Christopher Curran          Migration and Labor Dynamics                   4
152 Katie Gillespie             Migration, Health and Trauma                   4
153 Catherine Losier            Migration, Identity, and Health                4
154 Catherine Losier            Migration, Health, Geopolitics, Hi…            1
155 Barry C. Gaulton            Migration, Health, Geopolitics, Hi…            1
156 August Carbonella           Migration, Ethnicity, and Economy              4
157 August Carbonella           Multiculturalism, Politics, Migrat…            1
158 Nicholas Lynch              Migration, Aging, and Tourism Stud…            1
159 Russell Dawe                Migration, Health and Trauma                   1
160 Kodjo Attikpoé              Migration and Exile Studies                    1
161 Lorna Bennett               Migration, Health and Trauma                   1
162 Jennifer L. Buckle          Migration, Health and Trauma                   3
163 Mariya Lesiv                Diaspora, migration, transnational…            2
164 Mariya Lesiv                Migration, Ethnicity, and Economy              1
165 John Bodner                 Multiculturalism, Politics, Migrat…            1
166 Calvin Hollett              Migration, Aging, and Tourism Stud…            1
167 A. K. M. Shahidullah        Climate Change, Adaptation, Migrat…            1
168 Rebecca J. Franklin         Migration, Ethnicity, and Economy              2
169 Beth Leavenworth DuFault    Migration, Ethnicity, and Economy              1
170 Raquel Ruiz‐Díaz            Climate Change, Adaptation, Migrat…            3
171 Leanna Butters              Migration, Aging, and Tourism Stud…            5
172 Jacqueline Hesson           Migration, Health and Trauma                   1
173 Jennifer Thorburn           Diaspora, migration, transnational…            7
174 Jennifer Thorburn           Migration and Labor Dynamics                   7
175 Madonna M. Murphy           Migration, Health and Trauma                   1
176 Roberta Buchanan            Multiculturalism, Politics, Migrat…            1
177 Sean W. D. Gray             Migration, Refugees, and Integrati…            3
178 Cory W. Thorne              Diaspora, migration, transnational…            1
179 Michael Skipton             Migration, Policy, and Dickens Stu…            2
180 Neil J. Vincent             Migration, Health and Trauma                   1
181 Devonne Ryan                Migration, Aging, and Tourism Stud…            1
182 Margo Wilson                Migration, Health and Trauma                   1
183 Michael D. Kirkpatrick      Migration, Ethnicity, and Economy              1
184 Kate Lahey                  Climate Change, Adaptation, Migrat…            1
185 Elias Bartellas             Migration, Health and Trauma                   1
186 Mohamed Salah Eddine Madiou Climate Change, Adaptation, Migrat…            1
187 Elise Thorburn              Migration, Aging, and Tourism Stud…            1
188 Leslie J. Cake              Migration, Aging, and Tourism Stud…            1
189 Hua Que                     Migration, Health and Trauma                   6
190 Hua Que                     Migration and Labor Dynamics                   3
191 Hua Que                     Migration, Refugees, and Integrati…            2
192 Caroline Guinard            Migration, Identity, and Health                1
193 Ban Younghusband            Macrophage Migration Inhibitory Fa…            1
194 Jessica Squires             Macrophage Migration Inhibitory Fa…            1
195 Tyler R. Pritchard          Migration, Health and Trauma                   2
196 Raleen Murphy               Migration, Health and Trauma                   2
197 Darren Hynes                Migration, Health, Geopolitics, Hi…            1
198 Halia Koo                   Multiculturalism, Politics, Migrat…            1
199 Alka Agarwal-Mawal          Macrophage Migration Inhibitory Fa…            1
200 Jieying Xiong               Macrophage Migration Inhibitory Fa…            1
# ℹ 7 more rows</code></pre>
</div>
</div>
<p>Let’s store this subset of data for later.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>migration_authors <span class="ot">&lt;-</span> authors_data <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(display_name, topics, works_count, cited_by_count) <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(topics, <span class="at">names_sep =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">str_detect</span>(topics_display_name, <span class="fu">regex</span>(search_topic, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(display_name, topics_display_name, topics_count, topics_display_name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="key-concepts-and-common-words" class="level2">
<h2 class="anchored" data-anchor-id="key-concepts-and-common-words">Key Concepts and Common Words</h2>
<p>What are some of the key concepts that show up in research on migration conducted by Memorial researchers? One simple way to get at this idea is to simply take every unique word that appears across titles and count the number of times it appears. It’s crude, but a useful first pass to get a sense of what we have.</p>
<p>To do this, we’ll use another package: <code>tidytext</code> for “natural language processing”. We’ll load the library and then start our pipeline by piping the <code>migration_authors</code> data into the <code>tidytext</code>’s <code>unnest_tokens()</code> function. <code>unnest_tokens()</code> splits the <code>topics_display_name</code> column into individual words (tokens). Each word becomes a separate row in the dataset, and the new column is named word. Then we pipe that output into <code>count(word, sort = TRUE)</code> to counts the occurrences of each unique word in the word column. The <code>sort = TRUE</code> argument sorts the results in descending order of frequency.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidytext)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>word_counts <span class="ot">&lt;-</span> migration_authors <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest_tokens</span>(word, topics_display_name) <span class="sc">%&gt;%</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(word, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(word_counts, <span class="at">n =</span> <span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 48 × 2
   word                 n
   &lt;chr&gt;            &lt;int&gt;
 1 migration          204
 2 and                149
 3 health              44
 4 economy             36
 5 ethnicity           36
 6 trauma              33
 7 studies             26
 8 dynamics            24
 9 identity            23
10 labor               23
11 aging               21
12 tourism             21
13 adaptation          16
14 change              16
15 climate             16
16 diaspora            16
17 transnational       16
18 gender              12
19 multiculturalism    12
20 politics            12
21 integration         10
22 refugees            10
23 factor               9
24 inhibitory           9
25 macrophage           9
26 dickens              4
27 geography            4
28 geopolitics          4
29 historical           4
30 human                4
31 policy               4
32 rights               4
33 social               4
34 european             3
35 immigration          3
36 issues               3
37 italian              3
38 law                  3
39 china's              2
40 education            2
41 global               2
42 influence            2
43 racism               2
44 exile                1
45 indigenous           1
46 intercultural        1
47 labour               1
48 market               1</code></pre>
</div>
</div>
</section>
<section id="visualizing-word-frequencies" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-word-frequencies">Visualizing Word Frequencies</h2>
<p>Let’s make a <strong>horizontal bar graph</strong> (where the words are on the y-axis and word frequency is on the x-axis) to visualize this distribution of words. We’ll also remove “stop words” like “and,” “of,” etc.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"stop_words"</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>filtered_word_counts <span class="ot">&lt;-</span> word_counts <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">anti_join</span>(stop_words, <span class="at">by =</span> <span class="st">"word"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And now for the bar graph!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(filtered_word_counts, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(word, n), <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Word Frequency in Migration Research"</span>,</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Words"</span>,</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Frequency"</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lecture-10-content_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Remember you can save your plot with the <code>ggsave</code> function!</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"migration_word_frequency.png"</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="fields" class="level2">
<h2 class="anchored" data-anchor-id="fields">Fields</h2>
<p>The <code>topics</code> data also include “field” classifications. These are <em>multi-level</em> labels attached to publications. By multi-level I mean that some labels are very high-level (e.g., social sciences, sociology) while others are most focused (e.g., sociology of gender, racial inequality). Let’s make a table counting the number of fields in the Memorial Data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>field_counts <span class="ot">&lt;-</span> authors_data <span class="sc">%&gt;%</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(topics) <span class="sc">%&gt;%</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(topics) <span class="sc">%&gt;%</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(display_name, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(field_counts, <span class="at">n =</span> <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4,285 × 2
   display_name                                             n
   &lt;chr&gt;                                                &lt;int&gt;
 1 Physical Sciences                                    19166
 2 Social Sciences                                      19144
 3 Health Sciences                                      11962
 4 Medicine                                              9367
 5 Life Sciences                                         7845
 6 Engineering                                           5632
 7 Environmental Science                                 3947
 8 Biochemistry, Genetics and Molecular Biology          3740
 9 Arts and Humanities                                   2519
10 Computer Science                                      2375
11 Earth and Planetary Sciences                          2334
12 Health Professions                                    2107
13 Agricultural and Biological Sciences                  2075
14 Molecular Biology                                     1995
15 Sociology and Political Science                       1958
16 Psychology                                            1934
17 Chemistry                                             1408
18 General Health Professions                            1395
19 Materials Science                                     1199
20 Education                                             1189
21 Neuroscience                                          1164
22 Ecology                                               1147
23 Physics and Astronomy                                 1121
24 Electrical and Electronic Engineering                  943
25 Surgery                                                903
26 Genetics                                               894
27 Public Health, Environmental and Occupational Health   890
28 Economics, Econometrics and Finance                    885
29 Business, Management and Accounting                    830
30 Global and Planetary Change                            776
# ℹ 4,255 more rows</code></pre>
</div>
</div>
<p>A few things jump out at me from this list of the top 30 topics. First, publication output in the physical and social sciences at Memorial are neck and neck! If you were to combine Health, Medicine, and Life Sciences, they would top the list. Arts and Humanities is pretty high on this list to, claiming the number 9 rank. Sociology and Political Science are at rank 15.</p>
<p>Let’s ggplot!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>top_n_fields <span class="ot">&lt;-</span> field_counts <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">100</span>, n)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(top_n_fields, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(display_name, n), <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Top 30 Fields in Memorial University Publications"</span>,</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Fields"</span>,</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Count"</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lecture-10-content_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We’ll stop there for today. Tomorrow we’ll work on the second Data Stories assignment in class. <strong>It’s due on Monday March 10th.</strong></p>


</section>
</section>

<script async="" defer="" src="https://scripts.simpleanalyticscdn.com/latest.js"></script></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/www\.johnmclevey\.com\/quantitative-research-methods\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Built with <a href="https://quarto.org">Quarto</a> and <a href="https://github.com">GitHub</a> by <a href="https://www.johnmclevey.com">John McLevey</a></p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>